---
title: "Individual differences in visual perception in adults"
author: "Rick Gilmore, Yiming Qian, & Andrea Seisler"
date: "`r Sys.time()`"
output: 
  html_document:
    toc: true
    toc_depth: 5
    toc_float: true
    self_contained: false
    code_folding: hide    
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Purpose

This document serves as the master protocol for the study.

# Key references

Abramov, I., Gordon, J., Feldman, O., & Chavarga, A. (2012). Sex & vision I: Spatio-temporal resolution. *Biology of Sex Differences*, *3*(1), 20. Retrieved from http://dx.doi.org/10.1186/2042-6410-3-20

Murray, S. O., Schallmo, M.-P., Kolodny, T., Millin, R., Kale, A., Thomas, P., Rammsayer, T. H., et al. (2018). Sex differences in visual motion processing. *Current Biology*. Retrieved from http://dx.doi.org/10.1016/j.cub.2018.06.014

# IRB

This protocol, "Individual differences in visual perception in adults," has been assigned protocol number 13345.
The most recent IRB approval was granted on 2010-10-14.
Files related to the approved (exempt) submission can be found [here](../irb/2019-10-24).

# Prior to data collection start {.tabset}

## Equipment preparation

First, we need to do benchmark testing to determine what screen resolution will work at the highest temporal resolution (120 Hz).
This study requires high temporal resolution in order to measure temporal thresholds--the shortest stimulus duration that participants require in order to accurately detect the direction of motion.

Once we have determined the best monitor settings, we will calibrate the monitor before we start collecting data.
Those steps follow.

```{r, child="calibrate-monitor.Rmd"}
```

We may check the monitor calibration during data collection at a frequency we will decide later.

## Survey preparation

This study uses Qualtrics to collect implied/oral consent and other data from participants.
Yiming has generated a draft survey, saved [here](qualtrics_survey.qsf) as a `*.qsf` format text file.

The URL for the survey is <https://pennstate.qualtrics.com/jfe/form/SV_1FCXbmrfTWprQON>

# Scheduling participants {.tabset}

## Overview

Rick Gilmore is the PI on the SONA Systems study (Study ID 2587) associated with this protocol.
Yiming Qian and Andrea Seisler are researchers.
The URL is <https://pennstate.sona-systems.com/exp_info.aspx?experiment_id=2587>.

The process of scheduling participants involves the following steps:

1. Create slots on SONA with specific dates and times
2. When slot is scheduled, email sent to Yiming and Andrea.
3. Scheduled slots will be added to lab calendar.
  - The scheduled RA will be added to the title of the slot
  - The RA will also be invited to the google calendar event.
4. Researchers will be contacted by email and Discord by Yiming or Andrea if they are needed for a slot that is not part of their regularly scheduled lab time.

## Weekly testing slots

| Day of Week | Time    | Researcher(s)             | Lead   |     
|-------------|---------|---------------------------|--------|
| Mon         | 09:00a  | Rachel                    | Andrea |
|             | 10:15a  | Sandy, Emily, Rachel      | Andrea |
|             | 11:30a  | Sandy, Emily, Amar        | Yiming |
|             | 1p      |                           | Yiming |
|             | 2:15p   |                           | Yiming |
|             | 3:30p   |                           | Yiming |
|             | 4:45p   |                           | Yiming |
| Tue         | 9a      | Michelle, Rachel          | Andrea |
|             | 10:15a  | Michelle, Rachel          | Andrea |
|             | 11:30a  | Amar, Michelle            | Andrea |
|             | 12:45p  | Michelle, Joseph, Amar    | Andrea |
| Wed         | 10a     | Sandy, Rachel, Amar, Emily| Yiming |
|             | 11:15a  | Sandy, Rachel, Amar, Emily| Andrea |
|             | 12:30p  | Luka                      | Andrea |
|             | 1:45p   |                           | Yiming |
|             | 3p      |                           | Yiming |
|             | 4:15p   |                           | Yiming |
|             | 5:30p   |                           | Yiming |
| Thu         | 9a      | Joseph, Michelle, Luka,Rachel    | Yiming |
|             | 01:00p  |                           | Yiming |
|             | 02:15p   |                           | Yiming |
|             | 03:30p   |                           | Yiming |
|             | 04:45p   |                           | Yiming |
| Tue         | 09:00a   | Michelle, Rachel          | Andrea |
|             | 10:15a   | Michelle, Rachel          | Andrea |
|             | 11:30a   | Amar, Michelle            | Andrea |
|             | 12:45p   | Michelle, Joseph, Amar    | Andrea |
| Wed         | 10:00a   | Sandy, Rachel, Amar       | Yiming |
|             | 11:15a   | Sandy, Rachel, Amar, Emily| Andrea |
|             | 12:30p   | Luka                      | Andrea |
|             | 01:45p   |                           | Yiming |
|             | 03:00p   |                           | Yiming |
|             | 04:15p   |                           | Yiming |
|             | 05:30p   |                           | Yiming |
| Thu         | 09:00a   | Joseph, Michelle, Luka,Rachel    | Yiming |
|             | 10:15   | Rachel                    | Yiming |
|             | 11:30a  | Amar                      | Yiming |
|             | 01:30p  | Luka                      | Yiming |
|             | 02:45p  |                           | Yiming |
|             | 04:00p  |                           | Yiming |
|             | 05:15p  |                           | Yiming |
| Fri         | 09:00a  | Rachel                    | Yiming |
|             | 10:15a  | Rachel, Emily, Amar       | Yiming |
|             | 11:30a  | Rachel, Emily, Amar       | Andrea |
|             | 12:45p  | Emily, Amar               | Andrea |
|             | 02:00p  | Michelle                  | Yiming |
|             | 03:15p   |                           | Yiming |
|             | 04:30p   |                           | Yiming |

# Day of visit

```{r, child="test-session-protocol.Rmd"}
```

# Data processing

The following diagram depicts the post-study data processing workflow.

```{r}
library(DiagrammeR)

DiagrammeR::grViz("digraph {
graph [layout = dot, rankdir = LR]

# define the global styles of the nodes. We can override these in box if we wish
node [shape = rectangle, style = filled, fillcolor = Linen]

murray [label = 'Murray', shape = folder, fillcolor = Beige]
abramov [label = 'Abramov', shape = folder, fillcolor = Beige]
survey [label = 'Qualtrics']
test_computer [label = 'Task\ncomputer']
survey_computer [label ='Survey\ncomputer']
other_computer [label = 'Unspecified\ncomputer']
flash_drive [label='Flash\ndrive']
unspecified_process [label='TBD']
box [label = 'Box.com' fillcolor = White]
qualtrics_server [label = 'Qualtrics\nServer' fillcolor = White]

# edge definitions with the node IDs
{murray abramov} -> test_computer -> flash_drive -> other_computer -> box
survey -> survey_computer -> qualtrics_server -> unspecified_process -> box
}")
```

## Gathering

### Retrieve Behavioral Data

- Output data files from the computer task are stored
  - /Documents/PsychoPy-Stimuli/**Murray Folder Name**/csv
  - /Documents/PsychoPy-Stimuli/**Abramov Folder Name**/data

- Data must be copied to the **Gilmore Lab Participant Data** drive from the testing PC.
- Data will be copied to Box (XXX).
- After data export is complete, turn off computer and monitor in 503B.

### Retrieve Qualtrics Data 

- Log in to Qualtrics <https://pennstate.qualtrics.com/>
  - To review total summary, which shows total graph summary of survey distribution 
    - Click on **Distributions** tab
  -  To review individual responses to survey questions
    - Click on **Data & Analysis** tab
    - Under **Actions** click to open drop down menu
    - Click **view response**

### Transfer vision screening data

- Vision Screening Data will be entered into the last page of the Qualtrics Survey.

## Validation and cleaning

The `analysis/session_qa.Rmd` script imports a data file specified as an input parameter, for example: `rmarkdown::render('analysis/session_qa.Rmd', params = list(data_fn='2019-10-29-140253_temp_thresh.csv'))`. 
The script should be improved to output a custom HTML or PDF report for each participant file.
To view an example, visit [this link](https://gilmore-lab.github.io/sex-differences-in-motion-perception/analysis/session_qa.html).

## Visualization

## Analysis

# Appendices

```{r terminology, child="terminology.Rmd"}
```

```{r parameters, child="parameters.Rmd"}
```
