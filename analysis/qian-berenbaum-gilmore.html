<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Yiming Qian &amp; Rick Gilmore" />


<title>Analyses for write-up</title>

<script src="qian-berenbaum-gilmore_files/header-attrs-2.9/header-attrs.js"></script>
<script src="qian-berenbaum-gilmore_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="qian-berenbaum-gilmore_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="qian-berenbaum-gilmore_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="qian-berenbaum-gilmore_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="qian-berenbaum-gilmore_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="qian-berenbaum-gilmore_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="qian-berenbaum-gilmore_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="qian-berenbaum-gilmore_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="qian-berenbaum-gilmore_files/navigation-1.1/tabsets.js"></script>
<script src="qian-berenbaum-gilmore_files/navigation-1.1/codefolding.js"></script>
<link href="qian-berenbaum-gilmore_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="qian-berenbaum-gilmore_files/highlightjs-9.12.0/highlight.js"></script>
<script src="qian-berenbaum-gilmore_files/kePrint-0.0.1/kePrint.js"></script>
<link href="qian-berenbaum-gilmore_files/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="report.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Analyses for write-up</h1>
<h4 class="author">Yiming Qian &amp; Rick Gilmore</h4>
<h4 class="date">2021-07-09 13:36:18</h4>

</div>


<div id="purpose" class="section level1">
<h1>Purpose</h1>
<p>This document shows our analyses following the preregistered plan. It also shows the results of trimming all cases whose scores on either of the visual perception measures exceed 3 SDs from the pooled mean.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>Set chunk options and load libraries.</p>
</div>
<div id="import-and-clean" class="section level1">
<h1>Import and clean</h1>
<p>We import data previously cleaned to remove cases where accuracy is lower than the guess rate and any zero scores in the survey measures.</p>
<pre class="r"><code># load the data and make each variable right
df1 &lt;- readr::read_csv(file.path(params$data_path, params$csv_fn)) </code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   Sex = col_character(),
##   Race = col_character(),
##   Major = col_character(),
##   Color_vision = col_logical()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<div id="exclude-outliers" class="section level2">
<h2>Exclude outliers</h2>
<p>We detect outliers 3 SD from the grouped mean.</p>
<pre class="r"><code># define a function to remove outliers
FindOutliers &lt;-
  function(data,
           sd_thresh = as.numeric(params$outlier_sd_thresh)) {
    sd = sd(data, na.rm = T)
    mean = mean(data, na.rm = T)
    # we identify extreme outliers
    extreme.threshold.upper = (sd * sd_thresh) + mean
    extreme.threshold.lower = -(sd * sd_thresh) + mean
    result &lt;-
      which(data &gt; extreme.threshold.upper |
              data &lt; extreme.threshold.lower)
    print(result)
  }

outliers &lt;- lapply(df1, FindOutliers)</code></pre>
<pre><code>## integer(0)</code></pre>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion</code></pre>
<pre><code>## Warning in mean.default(data, na.rm = T): argument is not numeric or logical:
## returning NA</code></pre>
<pre><code>## integer(0)</code></pre>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion

## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): argument is not numeric or logical: returning NA</code></pre>
<pre><code>## integer(0)
## [1]  1 21 56
## integer(0)</code></pre>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion

## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): argument is not numeric or logical: returning NA</code></pre>
<pre><code>## integer(0)
## integer(0)
## integer(0)
## [1]  39  59 104
## integer(0)
## [1] 42 47 79
## [1] 125 128
## [1] 125
## [1] 119 125
## [1]  16 129
## [1]   9 114 129
## [1]   9 114
## integer(0)
## integer(0)
## integer(0)
## integer(0)
## integer(0)
## integer(0)
## integer(0)
## [1] 56
## integer(0)
## [1] 56</code></pre>
<pre class="r"><code>outliers</code></pre>
<pre><code>## $Participant
## integer(0)
## 
## $Sex
## integer(0)
## 
## $Race
## integer(0)
## 
## $Age
## [1]  1 21 56
## 
## $School_year
## integer(0)
## 
## $Major
## integer(0)
## 
## $Handedness
## integer(0)
## 
## $Glasses
## integer(0)
## 
## $Acuity
## [1]  39  59 104
## 
## $Color_vision
## integer(0)
## 
## $Stereo
## [1] 42 47 79
## 
## $motion_dur_thr
## [1] 125 128
## 
## $motion_dur_thr_mean
## [1] 125
## 
## $motion_dur_thr_sd
## [1] 119 125
## 
## $contrast_thr
## [1]  16 129
## 
## $contrast_thr_mean
## [1]   9 114 129
## 
## $contrast_thr_sd
## [1]   9 114
## 
## $vocab
## integer(0)
## 
## $Vocabulary_scores_cor_num
## integer(0)
## 
## $mental_rot
## integer(0)
## 
## $Mental_Rotation_scores_both
## integer(0)
## 
## $Feminine_hobbies
## integer(0)
## 
## $Masculine_hobbies
## integer(0)
## 
## $hobby_mean
## integer(0)
## 
## $femscale
## [1] 56
## 
## $masscale
## integer(0)
## 
## $mf
## [1] 56</code></pre>
<p>Exclude the outliers and create a new data frame.</p>
<pre class="r"><code>df2 &lt;- df1
df2$contrast_thr[outliers[[&#39;contrast_thr&#39;]]] &lt;- NA
df2$motion_dur_thr[outliers[[&#39;motion_dur_thr&#39;]]] &lt;- NA

df2 &lt;- df2 %&gt;%
  dplyr::mutate(.,
                log_contrast = log(contrast_thr),
                log_motion = log(motion_dur_thr))
# df2 &lt;- df1[-c(outliers[[&#39;contrast_thr&#39;]], outliers[[&#39;motion_dur_thr&#39;]]),] # we cannot use this code, because there is overlap in the outliers of these two threshold. It will delete one good data.</code></pre>
<pre class="r"><code>str(df2)</code></pre>
<pre><code>## spec_tbl_df [132 × 29] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ Participant                : num [1:132] 101 102 103 104 105 106 107 108 109 110 ...
##  $ Sex                        : chr [1:132] &quot;Females&quot; &quot;Females&quot; &quot;Females&quot; &quot;Males&quot; ...
##  $ Race                       : chr [1:132] &quot;,Caucasian&quot; &quot;,Caucasian&quot; &quot;Asian,Caucasian&quot; &quot;,Caucasian&quot; ...
##  $ Age                        : num [1:132] 4 1 2 1 2 1 1 1 2 1 ...
##  $ School_year                : num [1:132] 3 1 3 1 3 1 1 2 3 1 ...
##  $ Major                      : chr [1:132] &quot;Psychology&quot; &quot;DUS&quot; &quot;Psychology&quot; &quot;AD/PR&quot; ...
##  $ Handedness                 : num [1:132] 3 2 2 2 2 2 1 2 2 1 ...
##  $ Glasses                    : num [1:132] NA NA NA NA NA NA NA NA NA NA ...
##  $ Acuity                     : num [1:132] 21 21 21 20 21 20 20 21 20 21 ...
##  $ Color_vision               : logi [1:132] NA NA NA NA NA NA ...
##  $ Stereo                     : num [1:132] 12 7 12 12 12 12 10 12 12 12 ...
##  $ motion_dur_thr             : num [1:132] 0.0962 0.0862 0.1011 0.188 0.1101 ...
##  $ motion_dur_thr_mean        : num [1:132] 0.0959 0.0862 0.1019 0.19 0.1116 ...
##  $ motion_dur_thr_sd          : num [1:132] 0.00423 0.00631 0.01397 0.07925 0.00589 ...
##  $ contrast_thr               : num [1:132] 0.14 0.165 0.166 0.273 0.193 ...
##  $ contrast_thr_mean          : num [1:132] 0.14 0.198 0.164 0.262 0.191 ...
##  $ contrast_thr_sd            : num [1:132] 0.00441 0.07749 0.02693 0.07229 0.02735 ...
##  $ vocab                      : num [1:132] 9 10 8 5 14.8 ...
##  $ Vocabulary_scores_cor_num  : num [1:132] 11 15 11 11 19 16 17 11 12 10 ...
##  $ mental_rot                 : num [1:132] 37 19 24 21 36 31 27 20 23 15 ...
##  $ Mental_Rotation_scores_both: num [1:132] 17 3 6 4 16 11 11 6 6 2 ...
##  $ Feminine_hobbies           : num [1:132] 3.74 3.89 3.79 2.95 3.63 ...
##  $ Masculine_hobbies          : num [1:132] 3.24 3.29 2.57 3.48 2.71 ...
##  $ hobby_mean                 : num [1:132] 3.65 3.67 3.25 3.37 3.42 ...
##  $ femscale                   : num [1:132] 0.0868 0.2281 0.5395 -0.4193 0.2149 ...
##  $ masscale                   : num [1:132] -0.412 -0.381 -0.679 0.11 -0.702 ...
##  $ mf                         : num [1:132] -0.499 -0.609 -1.218 0.529 -0.917 ...
##  $ log_contrast               : num [1:132] -1.97 -1.8 -1.8 -1.3 -1.64 ...
##  $ log_motion                 : num [1:132] -2.34 -2.45 -2.29 -1.67 -2.21 ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   Participant = col_double(),
##   ..   Sex = col_character(),
##   ..   Race = col_character(),
##   ..   Age = col_double(),
##   ..   School_year = col_double(),
##   ..   Major = col_character(),
##   ..   Handedness = col_double(),
##   ..   Glasses = col_double(),
##   ..   Acuity = col_double(),
##   ..   Color_vision = col_logical(),
##   ..   Stereo = col_double(),
##   ..   motion_dur_thr = col_double(),
##   ..   motion_dur_thr_mean = col_double(),
##   ..   motion_dur_thr_sd = col_double(),
##   ..   contrast_thr = col_double(),
##   ..   contrast_thr_mean = col_double(),
##   ..   contrast_thr_sd = col_double(),
##   ..   vocab = col_double(),
##   ..   Vocabulary_scores_cor_num = col_double(),
##   ..   mental_rot = col_double(),
##   ..   Mental_Rotation_scores_both = col_double(),
##   ..   Feminine_hobbies = col_double(),
##   ..   Masculine_hobbies = col_double(),
##   ..   hobby_mean = col_double(),
##   ..   femscale = col_double(),
##   ..   masscale = col_double(),
##   ..   mf = col_double()
##   .. )</code></pre>
<pre class="r"><code>df2$Age &lt;- factor(df2$Age, levels = 1:4, labels = 1:4)</code></pre>
</div>
</div>
<div id="demographic-information" class="section level1">
<h1>Demographic information</h1>
<p>Are there differences in participant demographics by sex?</p>
<pre class="r"><code>chisq.test(df2$Sex, df2$Age)</code></pre>
<pre><code>## Warning in chisq.test(df2$Sex, df2$Age): Chi-squared approximation may be
## incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df2$Sex and df2$Age
## X-squared = 1.6789, df = 3, p-value = 0.6416</code></pre>
<pre class="r"><code>chisq.test(df2$Sex, df2$School_year)</code></pre>
<pre><code>## Warning in chisq.test(df2$Sex, df2$School_year): Chi-squared approximation may
## be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df2$Sex and df2$School_year
## X-squared = 2.5633, df = 3, p-value = 0.464</code></pre>
<pre class="r"><code>table(df2$Sex, df2$Handedness)</code></pre>
<pre><code>##          
##            1  2  3
##   Females 10 82  9
##   Males    1 28  1</code></pre>
<pre class="r"><code>chisq.test(df2$Sex, df2$Handedness)</code></pre>
<pre><code>## Warning in chisq.test(df2$Sex, df2$Handedness): Chi-squared approximation may be
## incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  df2$Sex and df2$Handedness
## X-squared = 2.5371, df = 2, p-value = 0.2812</code></pre>
<pre class="r"><code>chisq.test(data.frame(hispanic = c(5, 1),
                      non = c(96, 29)))</code></pre>
<pre><code>## Warning in chisq.test(data.frame(hispanic = c(5, 1), non = c(96, 29))): Chi-
## squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  data.frame(hispanic = c(5, 1), non = c(96, 29))
## X-squared = 3.1095e-30, df = 1, p-value = 1</code></pre>
<pre class="r"><code>chisq.test(data.frame(
  asian = c(37, 11),
  cas = c(49, 14),
  afric = c(13, 3),
  Pacificislander = c(1, 0),
  no = c(1, 2)
))</code></pre>
<pre><code>## Warning in chisq.test(data.frame(asian = c(37, 11), cas = c(49, 14), afric =
## c(13, : Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  data.frame(asian = c(37, 11), cas = c(49, 14), afric = c(13,     3), Pacificislander = c(1, 0), no = c(1, 2))
## X-squared = 3.7242, df = 4, p-value = 0.4446</code></pre>
<p>The male and female samples appear comparable.</p>
</div>
<div id="pregistered-analysis-plan" class="section level1">
<h1>Pregistered analysis plan</h1>
<p>See <a href="https://aspredicted.org/5iv9a.pdf" class="uri">https://aspredicted.org/5iv9a.pdf</a></p>
<blockquote>
<p>To examine how individual differences of visual perception measures are associated with other tasks, we will use correlations within sex. The lower visual perception threshold is, the higher perceptual sensitivity this individual has. In both sexes, we expect to find negative correlations between visual perception measures and spatial ability and masculine hobbies, but no significant correlation with verbal ability. There are four planned correlations (two visual perception tasks × two cognitive tasks) within sex, for a total of eight. This project is a novel study that has not to our knowledge been conducted previously. So we have consciously decided to maintain strict control of Type II error, in order to have enough statistical power to detect a small correlation effect sizes (r=0.20) within the constraints of sample size. This decision to maximize the power (.80) leads to a trade-off between Type I and Type II error. We plan to conduct eight separate one-tailed correlation tests with Type I error at 0.05 and no Bonferroni correction. With a critical p value of .05, around 150 participants are required for each group to detect an effect size of 0.20 at an obtained power of 0.8 with a one-tailed correlation test.</p>
</blockquote>
<p>Because our preregistration envisioned a much larger total sample, we have chosen to report the correlations by sex as planned and also for the combined sample.</p>
<p>We select the variables for our correlation analysis, and drop incomplete cases.</p>
<pre class="r"><code>df_corr &lt;- df2 %&gt;%
  dplyr::select(Sex,
                Age,
                log_contrast,
                log_motion,
                mental_rot,
                vocab,
                Masculine_hobbies,
                Feminine_hobbies,
                femscale,
                masscale)

df_complete &lt;- df_corr[stats::complete.cases(df_corr), ]

# Set the number of digits to display in the tables
options(digits = 2)</code></pre>
<p>This gives us <span class="math inline">\(n=\)</span> 122 complete cases.</p>
<p>We note that case 78 has threshold measures for motion and contrast but no data from the mental rotation, vocabulary, or hobbies measures.</p>
<pre class="r"><code>df_complete_F &lt;- df_complete %&gt;%
  dplyr::filter(., Sex == &#39;Females&#39;)
df_complete_M &lt;- df_complete %&gt;%
  dplyr::filter(., Sex == &#39;Males&#39;)

df_corr_F &lt;- df_corr %&gt;%
  dplyr::filter(., Sex == &#39;Females&#39;)
df_corr_M &lt;- df_corr %&gt;%
  dplyr::filter(., Sex == &#39;Males&#39;) </code></pre>
<div id="compute-one-tailed-correlations" class="section level2">
<h2>Compute one-tailed correlations</h2>
<div id="females" class="section level3">
<h3>Females</h3>
<pre class="r"><code>cor.test(
  df_complete_F$log_contrast,
  df_complete_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_contrast and df_complete_F$mental_rot
## t = -2, df = 90, p-value = 0.008
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.000 -0.081
## sample estimates:
##   cor 
## -0.25</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_contrast,
  df_complete_F$masscale,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_contrast and df_complete_F$masscale
## t = -1, df = 90, p-value = 0.1
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.000  0.049
## sample estimates:
##   cor 
## -0.12</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_contrast,
  df_complete_F$femscale,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_contrast and df_complete_F$femscale
## t = 2, df = 90, p-value = 0.007
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.085 1.000
## sample estimates:
##  cor 
## 0.25</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_motion,
  df_complete_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_motion and df_complete_F$mental_rot
## t = -3, df = 90, p-value = 0.002
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00 -0.13
## sample estimates:
##   cor 
## -0.29</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_motion,
  df_complete_F$masscale,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_motion and df_complete_F$masscale
## t = -0.6, df = 90, p-value = 0.3
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00  0.11
## sample estimates:
##    cor 
## -0.061</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_motion,
  df_complete_F$femscale,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_motion and df_complete_F$femscale
## t = 2, df = 90, p-value = 0.02
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.046 1.000
## sample estimates:
##  cor 
## 0.22</code></pre>
<div id="one-tailed-regression" class="section level4">
<h4>One-tailed regression</h4>
<pre class="r"><code>mod &lt;- lm(mental_rot ~ Age + log_contrast, data = df_complete_F)
res &lt;- summary(mod)
# For the two-sided hypotheses
2 * pt(-abs(coef(res)[, 3]), mod$df)</code></pre>
<pre><code>##  (Intercept)         Age2         Age3         Age4 log_contrast 
##        0.148        0.607        0.775        0.963        0.018</code></pre>
<pre class="r"><code># For H1: beta &lt; 0
pt(coef(res)[, 3], mod$df, lower = TRUE)</code></pre>
<pre><code>##  (Intercept)         Age2         Age3         Age4 log_contrast 
##        0.926        0.696        0.387        0.481        0.009</code></pre>
<pre class="r"><code>mod &lt;- lm(mental_rot ~ Age + masscale, data = df_complete_F)
res &lt;- summary(mod)

mod &lt;- lm(log_contrast ~ Age + masscale, data = df_complete_F)
res &lt;- summary(mod)

mod &lt;- lm(log_motion ~ Age + masscale, data = df_complete_F)
res &lt;- summary(mod)

mod &lt;- lm(log_contrast ~ Age + masscale, data = df_complete_M)
res &lt;- summary(mod)
mod &lt;- lm(log_motion ~ Age + masscale, data = df_complete_M)
res &lt;- summary(mod)</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_contrast,
  df_complete_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;,
  na.action = na.exclude
)  # for &#39;cor&#39; function, use=&quot;pairwise.complete.obs&quot;the cases with missing values are only removed during the calculation of each pairwise correlation, while use=&quot;complete.obs&quot;, the matrix m first has all cases with missing values removed</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_contrast and df_complete_F$mental_rot
## t = -2, df = 90, p-value = 0.008
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.000 -0.081
## sample estimates:
##   cor 
## -0.25</code></pre>
<pre class="r"><code># na.omit is listwise deletion (th whole row is deleted); na.exclude used the residuals and predictions are padded to the correct length by inserting NAs for cases omitted by na.exclude
cor.test(
  df_complete_F$log_contrast,
  df_complete_F$masscale,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;,
  na.action = na.exclude
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_contrast and df_complete_F$masscale
## t = -1, df = 90, p-value = 0.1
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.000  0.049
## sample estimates:
##   cor 
## -0.12</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_contrast,
  df_complete_F$femscale,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;,
  na.action = na.exclude
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_contrast and df_complete_F$femscale
## t = 2, df = 90, p-value = 0.007
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.085 1.000
## sample estimates:
##  cor 
## 0.25</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_motion,
  df_complete_F$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;,
  na.action = na.exclude
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_motion and df_complete_F$mental_rot
## t = -3, df = 90, p-value = 0.002
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00 -0.13
## sample estimates:
##   cor 
## -0.29</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_motion,
  df_complete_F$masscale,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;,
  na.action = na.exclude
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_motion and df_complete_F$masscale
## t = -0.6, df = 90, p-value = 0.3
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00  0.11
## sample estimates:
##    cor 
## -0.061</code></pre>
<pre class="r"><code>cor.test(
  df_complete_F$log_motion,
  df_complete_F$femscale,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;,
  na.action = na.exclude
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_F$log_motion and df_complete_F$femscale
## t = 2, df = 90, p-value = 0.02
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  0.046 1.000
## sample estimates:
##  cor 
## 0.22</code></pre>
</div>
</div>
<div id="males" class="section level3">
<h3>Males</h3>
<pre class="r"><code>cor.test(
  df_complete_M$log_contrast,
  df_complete_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_M$log_contrast and df_complete_M$mental_rot
## t = -1, df = 28, p-value = 0.1
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.000  0.067
## sample estimates:
##   cor 
## -0.24</code></pre>
<pre class="r"><code>cor.test(
  df_complete_M$log_contrast,
  df_complete_M$masscale,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_M$log_contrast and df_complete_M$masscale
## t = 0.06, df = 28, p-value = 0.5
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00  0.32
## sample estimates:
##   cor 
## 0.012</code></pre>
<pre class="r"><code>cor.test(
  df_complete_M$log_contrast,
  df_complete_M$femscale,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_M$log_contrast and df_complete_M$femscale
## t = -0.4, df = 28, p-value = 0.6
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  -0.37  1.00
## sample estimates:
##    cor 
## -0.067</code></pre>
<pre class="r"><code>cor.test(
  df_complete_M$log_motion,
  df_complete_M$mental_rot,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_M$log_motion and df_complete_M$mental_rot
## t = 0.6, df = 28, p-value = 0.7
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00  0.41
## sample estimates:
##  cor 
## 0.12</code></pre>
<pre class="r"><code>cor.test(
  df_complete_M$log_motion,
  df_complete_M$masscale,
  method = &quot;pearson&quot;,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_M$log_motion and df_complete_M$masscale
## t = 1, df = 28, p-value = 0.9
## alternative hypothesis: true correlation is less than 0
## 95 percent confidence interval:
##  -1.00  0.48
## sample estimates:
## cor 
## 0.2</code></pre>
<pre class="r"><code>cor.test(
  df_complete_M$log_motion,
  df_complete_M$femscale,
  method = &quot;pearson&quot;,
  alternative = &quot;greater&quot;
)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  df_complete_M$log_motion and df_complete_M$femscale
## t = -0.5, df = 28, p-value = 0.7
## alternative hypothesis: true correlation is greater than 0
## 95 percent confidence interval:
##  -0.4  1.0
## sample estimates:
##  cor 
## -0.1</code></pre>
</div>
</div>
<div id="correlation-matrix" class="section level2">
<h2>Correlation matrix</h2>
<div id="females-1" class="section level3">
<h3>Females</h3>
<p>Select the females, focus on the numeric scores, and calculate a correlation matrix.</p>
<pre class="r"><code>df_corr_F &lt;- df_complete_F %&gt;%
  dplyr::select(.,-Sex)

corr_F &lt;- Hmisc::rcorr(as.matrix(df_corr_F), type = c(&quot;pearson&quot;))</code></pre>
<div id="coefficients" class="section level4">
<h4>Coefficients</h4>
<pre class="r"><code>corr_F$r</code></pre>
<pre><code>##                       Age log_contrast log_motion mental_rot  vocab
## Age                1.0000        0.121      0.167     -0.018 -0.141
## log_contrast       0.1215        1.000      0.179     -0.268 -0.041
## log_motion         0.1671        0.179      1.000     -0.262 -0.176
## mental_rot        -0.0180       -0.268     -0.262      1.000  0.072
## vocab             -0.1409       -0.041     -0.176      0.072  1.000
## Masculine_hobbies -0.1785       -0.216      0.020     -0.059  0.029
## Feminine_hobbies  -0.1697        0.033      0.194     -0.336 -0.090
## femscale           0.0508        0.274      0.203     -0.311 -0.138
## masscale           0.0074       -0.161     -0.062      0.116  0.085
##                   Masculine_hobbies Feminine_hobbies femscale masscale
## Age                          -0.179           -0.170    0.051   0.0074
## log_contrast                 -0.216            0.033    0.274  -0.1612
## log_motion                    0.020            0.194    0.203  -0.0617
## mental_rot                   -0.059           -0.336   -0.311   0.1162
## vocab                         0.029           -0.090   -0.138   0.0852
## Masculine_hobbies             1.000            0.484   -0.433   0.5888
## Feminine_hobbies              0.484            1.000    0.498  -0.3194
## femscale                     -0.433            0.498    1.000  -0.6600
## masscale                      0.589           -0.319   -0.660   1.0000</code></pre>
</div>
<div id="p-values" class="section level4">
<h4>P values</h4>
<pre class="r"><code>corr_F$P</code></pre>
<pre><code>##                     Age log_contrast log_motion mental_rot vocab
## Age                  NA       0.2486      0.111     0.8647 0.180
## log_contrast      0.249           NA      0.088     0.0097 0.696
## log_motion        0.111       0.0876         NA     0.0115 0.094
## mental_rot        0.865       0.0097      0.012         NA 0.495
## vocab             0.180       0.6958      0.094     0.4951    NA
## Masculine_hobbies 0.089       0.0388      0.850     0.5771 0.784
## Feminine_hobbies  0.106       0.7525      0.064     0.0011 0.394
## femscale          0.631       0.0082      0.052     0.0026 0.190
## masscale          0.944       0.1247      0.559     0.2700 0.420
##                   Masculine_hobbies Feminine_hobbies femscale masscale
## Age                         8.9e-02          1.1e-01  6.3e-01  9.4e-01
## log_contrast                3.9e-02          7.5e-01  8.2e-03  1.2e-01
## log_motion                  8.5e-01          6.4e-02  5.2e-02  5.6e-01
## mental_rot                  5.8e-01          1.1e-03  2.6e-03  2.7e-01
## vocab                       7.8e-01          3.9e-01  1.9e-01  4.2e-01
## Masculine_hobbies                NA          1.0e-06  1.6e-05  6.7e-10
## Feminine_hobbies            1.0e-06               NA  4.3e-07  1.9e-03
## femscale                    1.6e-05          4.3e-07       NA  8.3e-13
## masscale                    6.7e-10          1.9e-03  8.3e-13       NA</code></pre>
<pre class="r"><code># Get some colors
col &lt;- colorRampPalette(c(&quot;blue&quot;, &quot;white&quot;, &quot;red&quot;))(20)
heatmap(x = corr_F$r, col = col, symm = TRUE)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="males-1" class="section level3">
<h3>Males</h3>
<p>Select the males and focus on the numeric scores.</p>
<pre class="r"><code>df_corr_m &lt;- df_complete %&gt;%
  dplyr::filter(., Sex == &#39;Males&#39;) %&gt;%
  dplyr::select(., -Sex)

corr_M &lt;- Hmisc::rcorr(as.matrix(df_corr_m), type = c(&quot;pearson&quot;))</code></pre>
<div id="coefficients-1" class="section level4">
<h4>Coefficients</h4>
<pre class="r"><code>corr_M$r</code></pre>
<pre><code>##                      Age log_contrast log_motion mental_rot   vocab
## Age                1.000      -0.2698     -0.130     -0.215 -0.0468
## log_contrast      -0.270       1.0000      0.358     -0.252 -0.1638
## log_motion        -0.130       0.3585      1.000      0.143 -0.2084
## mental_rot        -0.215      -0.2523      0.143      1.000 -0.1708
## vocab             -0.047      -0.1638     -0.208     -0.171  1.0000
## Masculine_hobbies -0.112       0.1190      0.141     -0.023 -0.0596
## Feminine_hobbies  -0.379       0.0216     -0.050      0.147 -0.0999
## femscale          -0.323      -0.1052     -0.098      0.283 -0.1487
## masscale           0.198       0.0096      0.210     -0.025  0.0034
##                   Masculine_hobbies Feminine_hobbies femscale masscale
## Age                          -0.112           -0.379   -0.323   0.1980
## log_contrast                  0.119            0.022   -0.105   0.0096
## log_motion                    0.141           -0.050   -0.098   0.2100
## mental_rot                   -0.023            0.147    0.283  -0.0252
## vocab                        -0.060           -0.100   -0.149   0.0034
## Masculine_hobbies             1.000            0.447   -0.290   0.5522
## Feminine_hobbies              0.447            1.000    0.660  -0.4012
## femscale                     -0.290            0.660    1.000  -0.6637
## masscale                      0.552           -0.401   -0.664   1.0000</code></pre>
</div>
<div id="p-values-1" class="section level4">
<h4>P values</h4>
<pre class="r"><code>corr_M$P</code></pre>
<pre><code>##                     Age log_contrast log_motion mental_rot vocab
## Age                  NA        0.149      0.494       0.25  0.81
## log_contrast      0.149           NA      0.052       0.18  0.39
## log_motion        0.494        0.052         NA       0.45  0.27
## mental_rot        0.254        0.179      0.451         NA  0.37
## vocab             0.806        0.387      0.269       0.37    NA
## Masculine_hobbies 0.554        0.531      0.457       0.90  0.75
## Feminine_hobbies  0.039        0.910      0.791       0.44  0.60
## femscale          0.082        0.580      0.605       0.13  0.43
## masscale          0.294        0.960      0.265       0.89  0.99
##                   Masculine_hobbies Feminine_hobbies femscale masscale
## Age                          0.5545          3.9e-02  8.2e-02  2.9e-01
## log_contrast                 0.5312          9.1e-01  5.8e-01  9.6e-01
## log_motion                   0.4567          7.9e-01  6.1e-01  2.7e-01
## mental_rot                   0.9020          4.4e-01  1.3e-01  8.9e-01
## vocab                        0.7545          6.0e-01  4.3e-01  9.9e-01
## Masculine_hobbies                NA          1.3e-02  1.2e-01  1.6e-03
## Feminine_hobbies             0.0133               NA  7.3e-05  2.8e-02
## femscale                     0.1194          7.3e-05       NA  6.4e-05
## masscale                     0.0016          2.8e-02  6.4e-05       NA</code></pre>
<pre class="r"><code># Get some colors
heatmap(x = corr_M$r, col = col, symm = TRUE)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
<div id="further-exclusions" class="section level3">
<h3>Further exclusions</h3>
<p>Evaluating the impact of two male outliers even after the 3 SD exclusion.</p>
<pre class="r"><code>out.m &lt;- lapply(df_complete_M[, 3:4], FindOutliers)</code></pre>
<pre><code>## [1] 1
## [1] 1</code></pre>
<pre class="r"><code>out.f &lt;- lapply(df_complete_F[, 3:4], FindOutliers)</code></pre>
<pre><code>## integer(0)
## [1] 64 87</code></pre>
<pre class="r"><code>df_complete_M2 &lt;-
  df_complete_M[-which(df_complete_M$log_motion &gt; -2),]
df_test &lt;- rbind(df_complete_M2, df_complete_F)
df_complete2 &lt;- df_test[stats::complete.cases(df_test),]</code></pre>
</div>
<div id="overall-for-the-outlier-excluded-datasets" class="section level3">
<h3>Overall for the outlier-excluded datasets</h3>
<pre class="r"><code>df_corr2 &lt;- df_complete2 %&gt;%
  dplyr::select(.,-Sex)

corr_all &lt;- Hmisc::rcorr(as.matrix(df_corr2), type = c(&quot;pearson&quot;))

corr_all</code></pre>
<pre><code>##                     Age log_contrast log_motion mental_rot vocab
## Age                1.00         0.02       0.07      -0.05 -0.11
## log_contrast       0.02         1.00       0.24      -0.29 -0.07
## log_motion         0.07         0.24       1.00      -0.23 -0.19
## mental_rot        -0.05        -0.29      -0.23       1.00  0.02
## vocab             -0.11        -0.07      -0.19       0.02  1.00
## Masculine_hobbies -0.08        -0.29      -0.21       0.07  0.06
## Feminine_hobbies  -0.25         0.16       0.27      -0.30 -0.12
## femscale          -0.11         0.35       0.36      -0.27 -0.17
## masscale           0.12        -0.31      -0.32       0.21  0.11
##                   Masculine_hobbies Feminine_hobbies femscale masscale
## Age                           -0.08            -0.25    -0.11     0.12
## log_contrast                  -0.29             0.16     0.35    -0.31
## log_motion                    -0.21             0.27     0.36    -0.32
## mental_rot                     0.07            -0.30    -0.27     0.21
## vocab                          0.06            -0.12    -0.17     0.11
## Masculine_hobbies              1.00             0.16    -0.60     0.72
## Feminine_hobbies               0.16             1.00     0.63    -0.50
## femscale                      -0.60             0.63     1.00    -0.81
## masscale                       0.72            -0.50    -0.81     1.00
## 
## n= 120 
## 
## 
## P
##                   Age    log_contrast log_motion mental_rot vocab 
## Age                      0.8065       0.4690     0.5978     0.2224
## log_contrast      0.8065              0.0090     0.0013     0.4672
## log_motion        0.4690 0.0090                  0.0120     0.0427
## mental_rot        0.5978 0.0013       0.0120                0.8463
## vocab             0.2224 0.4672       0.0427     0.8463           
## Masculine_hobbies 0.4007 0.0013       0.0247     0.4770     0.5229
## Feminine_hobbies  0.0059 0.0850       0.0026     0.0010     0.1746
## femscale          0.2316 0.0000       0.0000     0.0030     0.0587
## masscale          0.2013 0.0007       0.0004     0.0194     0.2132
##                   Masculine_hobbies Feminine_hobbies femscale masscale
## Age               0.4007            0.0059           0.2316   0.2013  
## log_contrast      0.0013            0.0850           0.0000   0.0007  
## log_motion        0.0247            0.0026           0.0000   0.0004  
## mental_rot        0.4770            0.0010           0.0030   0.0194  
## vocab             0.5229            0.1746           0.0587   0.2132  
## Masculine_hobbies                   0.0812           0.0000   0.0000  
## Feminine_hobbies  0.0812                             0.0000   0.0000  
## femscale          0.0000            0.0000                    0.0000  
## masscale          0.0000            0.0000           0.0000</code></pre>
</div>
</div>
</div>
<div id="visualizations" class="section level1">
<h1>Visualizations</h1>
<div id="define-helper-functions" class="section level2">
<h2>Define helper functions</h2>
<p>We create several functions to make our graphs have similar appearance.</p>
<pre class="r"><code>sex_diff_scatter &lt;-
  function(df,
           x_var,
           y_var,
           x_rev = FALSE,
           y_rev = FALSE,
           an_f = &quot;&quot;,
           an_m = &quot;&quot;,
           anx = NULL,
           any = NULL,
           x_lab = &quot;X axis&quot;,
           y_lab = &quot;Y axis&quot;,
           square_axis = TRUE) {
    require(tidyverse)
    require(ggExtra)
    
    x_var_s &lt;- sym(x_var)
    y_var_s &lt;- sym(y_var)
    
    p &lt;- ggplot(df) +
      aes(
        x = !!x_var_s,
        y = !!y_var_s,
        group = Sex,
        color = Sex
      ) +
      geom_point() +
      xlab(x_var) +
      ylab(y_var) +
      stat_smooth(method = &quot;lm&quot;, na.rm = TRUE) +
      theme_classic2() +
      theme(legend.position = &quot;bottom&quot;,
            legend.title = element_blank()) +
      xlab(x_lab) +
      ylab(y_lab) +
      annotate(
        &quot;text&quot;,
        x = anx,
        y = any,
        label = c(an_f, an_m),
        color = c(&#39;red&#39;, &#39;darkturquoise&#39;)
      )
    
    if (square_axis)
    {
      p + coord_fixed()
    }
    
    if (stringr::str_detect(x_var, &#39;hobbies&#39;)) {
      p &lt;- p + xlim(1, 5)
    }
    if (stringr::str_detect(y_var, &#39;hobbies&#39;)) {
      p &lt;- p + ylim(1, 5)
    }
    
    # Reverse scale for threshold measures?
    if (x_rev)
      p &lt;- p + scale_x_reverse()
    if (y_rev)
      p &lt;- p + scale_y_reverse()
    
    p1 &lt;- ggExtra::ggMarginal(p,
                              type = &quot;density&quot;,
                              margins = &quot;both&quot;,
                              groupFill = TRUE)
    p1
  }</code></pre>
<pre class="r"><code>sex_diff_corr_summ &lt;- function(x_var, y_var, print_table = TRUE, 
                               corr_all_df = corr_all,
                               corr_M_df = corr_M,
                               corr_F_df = corr_F) {
  require(tidyverse) # for %&gt;%
  
  corr_all_df &lt;- tibble::tibble(
    cor_coef = corr_all_df$r[x_var, y_var],
    p_val = corr_all_df$P[x_var, y_var],
    n =  corr_all_df$n[x_var, y_var],
    pop = &quot;Both&quot;
  )
  males_df &lt;- tibble::tibble(
    cor_coef = corr_M_df$r[x_var, y_var],
    p_val = corr_M_df$P[x_var, y_var],
    n =  corr_M_df$n[x_var, y_var],
    pop = &quot;Males&quot;
  )
  
  females_df &lt;- tibble::tibble(
    cor_coef = corr_F_df$r[x_var, y_var],
    p_val = corr_F_df$P[x_var, y_var],
    n =  corr_F_df$n[x_var, y_var],
    pop = &quot;Females&quot;
  )
  
  df &lt;- rbind(corr_all_df, males_df, females_df)
  
  df &lt;- df %&gt;%
    mutate(., stars = if_else(p_val &lt; .005, &quot;***&quot;,
                              if_else(
                                p_val &lt; .01, &quot;**&quot;,
                                if_else(p_val &lt; .05, &quot;*&quot;, &quot; ns&quot;)
                              )))
  
  
  if (print_table) {
    kableExtra::kable(df, format = &#39;html&#39;) %&gt;%
      kableExtra::kable_styling()
  } else {
    df
  }
}</code></pre>
</div>
<div id="motion-sensitivity-contrast-sensitivity" class="section level2">
<h2>Motion sensitivity &amp; contrast sensitivity</h2>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;,
                              &quot;log_contrast&quot;, print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;log_contrast&quot;,
  x_rev = TRUE,
  y_rev = TRUE,
  # &quot;r=0.22*&quot;,
  # &quot;r=0.54***&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.9, -2.04),
  c(-1.4, -1.98),
  &quot;log(motion threshold)&quot;,
  &quot;log(contrast threshold)&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-duration-contrast-sens-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;,
                   &quot;log_contrast&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
**
</td>
</tr>
<tr>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
<div id="motion-sensitivity-mental-rotation" class="section level2">
<h2>Motion sensitivity &amp; mental rotation</h2>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;,
                              &quot;mental_rot&quot;, print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;mental_rot&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.8,-1.9),
  c(30, 36),
  &quot;log(motion threshold)&quot;,
  &quot;Mental rotation score&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-duration-mental-rot-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;mental_rot&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.23
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
</div>
<div id="motion-sensitivity-vocabulary" class="section level2">
<h2>Motion sensitivity &amp; vocabulary</h2>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;, &quot;vocab&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;vocab&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = 0.18&quot;,
  # &quot;r=0.22&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-2.25),
  c(25, 23),
  &quot;log(motion threshold)&quot;,
  &quot;Vocabulary score&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-duration-vocab-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;vocab&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.19
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.18
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="motion-sensitivity-feminine-hobbies" class="section level2">
<h2>Motion sensitivity &amp; feminine hobbies</h2>
<div id="unscaled" class="section level3">
<h3>Unscaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;, &quot;Feminine_hobbies&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;Feminine_hobbies&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = 0.17*&quot;,
  # &quot;r = -0.01&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-2, -2.4),
  c(4.5, 1.8),
  &quot;log(motion threshold)&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-dur-fem-hobbies-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;Feminine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
<div id="scaled" class="section level3">
<h3>Scaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;, &quot;femscale&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;femscale&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = 0.17*&quot;,
  # &quot;r = -0.01&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-2,-2.4),
  c(1, -1),
  &quot;log(motion threshold)&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-sens-fem-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;femscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="motion-sensitivity-masculine-hobbies" class="section level2">
<h2>Motion sensitivity &amp; masculine hobbies</h2>
<div id="unscaled-1" class="section level3">
<h3>Unscaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;, &quot;Masculine_hobbies&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;Masculine_hobbies&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = 0.17*&quot;,
  # &quot;r = -0.01&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-2, -2.4),
  c(4.5, 1.8),
  &quot;log(motion threshold)&quot;,
  &quot;Interest in masculine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-dur-m-hobbies-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;Masculine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.21
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="scaled-1" class="section level3">
<h3>Scaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_motion&quot;, &quot;masscale&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_motion&quot;,
  &quot;masscale&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = 0.17*&quot;,
  # &quot;r = -0.01&quot;,
  paste0(&quot;r = &quot;, format(corr_df$cor_coef[3], digits = 2, nsmall = 2), corr_df$stars[3]),
  paste0(&quot;r = &quot;, format(corr_df$cor_coef[2], digits = 2, nsmall = 2), corr_df$stars[2]),
  c(-1.5,-2.4),
  c(-1, 1),
  &quot;log(motion threshold)&quot;,
  &quot;Interest in male_typed hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/motion-sens-masc-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_motion&quot;, &quot;masscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.32
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.06
</td>
<td style="text-align:right;">
0.56
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="contrast-sensitivity-mental-rotation" class="section level2">
<h2>Contrast sensitivity &amp; mental rotation</h2>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;mental_rot&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_contrast&quot;,
  &quot;mental_rot&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = -0.19*&quot;,
  # &quot;r = 0.12&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(33, 35),
  &quot;log(contrast threshold)&quot;,
  &quot;Mental rotation score&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/contrast-sens-mental-rot-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;mental_rot&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.29
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.25
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
**
</td>
</tr>
</tbody>
</table>
</div>
<div id="contrast-sensitivity-feminine-hobbies" class="section level2">
<h2>Contrast sensitivity &amp; feminine hobbies</h2>
<div id="unscaled-2" class="section level3">
<h3>Unscaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Feminine_hobbies&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_contrast&quot;,
  &quot;Feminine_hobbies&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = -0.19*&quot;,
  # &quot;r = 0.26&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(1.5, 4.2),
  &quot;log(contrast threshold)&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/contrast-sens-f-hobbies-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Feminine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
<div id="scaled-2" class="section level3">
<h3>Scaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;femscale&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_contrast&quot;,
  &quot;femscale&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = -0.19*&quot;,
  # &quot;r = 0.26&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(1.5, 4.2),
  &quot;log(contrast threshold)&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/contrast-sens-f-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;femscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.11
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
**
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="contrast-sensitivity-masculine-hobbies" class="section level2">
<h2>Contrast sensitivity &amp; masculine hobbies</h2>
<div id="unscaled-3" class="section level3">
<h3>Unscaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Masculine_hobbies&quot;,
                              print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  &quot;log_contrast&quot;,
  &quot;Masculine_hobbies&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = -0.19*&quot;,
  # &quot;r = 0.26&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(1.5, 4.2),
  &quot;log(contrast threshold)&quot;,
  &quot;Interest in masculine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/contrast-sens-m-hobbies-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;Masculine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.29
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="scaled-3" class="section level3">
<h3>Scaled</h3>
<pre class="r"><code>corr_df &lt;- sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;masscale&quot;,
                              print_table = FALSE)
sex_diff_scatter(
  df_complete2,
  &quot;log_contrast&quot;,
  &quot;masscale&quot;,
  x_rev = TRUE,
  y_rev = FALSE,
  # &quot;r = -0.19*&quot;,
  # &quot;r = 0.26&quot;,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  c(-1.5),
  c(1.5, 4.2),
  &quot;log(contrast threshold)&quot;,
  &quot;Interest in masculine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/contrast-sens-m-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;log_contrast&quot;, &quot;masscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="masculine-and-feminine-hobbies" class="section level2">
<h2>Masculine and feminine hobbies</h2>
<div id="unscaled-4" class="section level3">
<h3>Unscaled</h3>
<pre class="r"><code>corr_df &lt;-
  sex_diff_corr_summ(&quot;Masculine_hobbies&quot;, &quot;Feminine_hobbies&quot;, print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  x_var = &quot;Masculine_hobbies&quot;,
  y_var = &quot;Feminine_hobbies&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  anx = 3,
  any = c(1.9, 1.6),
  &quot;Interest in masculine hobbies&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/m-hobbies-f-hobbies-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;Masculine_hobbies&quot;, &quot;Feminine_hobbies&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
<div id="scaled-4" class="section level3">
<h3>Scaled</h3>
<pre class="r"><code>corr_df &lt;-
  sex_diff_corr_summ(&quot;masscale&quot;, &quot;femscale&quot;, print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  x_var = &quot;masscale&quot;,
  y_var = &quot;femscale&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  anx = 3,
  any = c(1.9, 1.6),
  &quot;Interest in masculine hobbies&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/m-hobbies-f-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;masscale&quot;, &quot;femscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.81
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.66
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.66
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="mental-rotation-scaled-hobbies" class="section level2">
<h2>Mental rotation &amp; (scaled) hobbies</h2>
<div id="feminine-hobbies" class="section level3">
<h3>Feminine hobbies</h3>
<pre class="r"><code>corr_df &lt;-
  sex_diff_corr_summ(&quot;mental_rot&quot;, &quot;femscale&quot;, print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  x_var = &quot;mental_rot&quot;,
  y_var = &quot;femscale&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  anx = 25,
  any = c(1,-1),
  &quot;mental rotation&quot;,
  &quot;Interest in feminine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/ment-rot-f-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;mental_rot&quot;, &quot;femscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.27
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
***
</td>
</tr>
<tr>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.31
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
***
</td>
</tr>
</tbody>
</table>
</div>
<div id="masculine-hobbies" class="section level3">
<h3>Masculine hobbies</h3>
<pre class="r"><code>corr_df &lt;-
  sex_diff_corr_summ(&quot;mental_rot&quot;, &quot;masscale&quot;, print_table = FALSE)

sex_diff_scatter(
  df_complete2,
  x_var = &quot;mental_rot&quot;,
  y_var = &quot;masscale&quot;,
  x_rev = FALSE,
  y_rev = FALSE,
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[3], digits = 2, nsmall = 2),
    corr_df$stars[3]
  ),
  paste0(
    &quot;r = &quot;,
    format(corr_df$cor_coef[2], digits = 2, nsmall = 2),
    corr_df$stars[2]
  ),
  anx = 25,
  any = c(1,-1),
  &quot;mental rotation&quot;,
  &quot;Interest in masculine hobbies&quot;
)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/ment-rot-m-hobbies-scaled-1.png" width="672" /></p>
<pre class="r"><code>sex_diff_corr_summ(&quot;mental_rot&quot;, &quot;masscale&quot;)</code></pre>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
cor_coef
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
n
</th>
<th style="text-align:left;">
pop
</th>
<th style="text-align:left;">
stars
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:left;">
Both
</td>
<td style="text-align:left;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:left;">
Males
</td>
<td style="text-align:left;">
ns
</td>
</tr>
<tr>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:left;">
Females
</td>
<td style="text-align:left;">
ns
</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
</div>
<div id="does-vision-account-for-mental-rotation" class="section level1">
<h1>Does vision account for mental rotation?</h1>
<p>There are two approaches to answering this question. One looks for sex differences in the residuals of the models <code>mental rotation ~ contrast</code> and <code>mental rotation ~ motion</code>. The other models <code>mental rotation ~ contrast + sex + contrast:sex</code> and determines whether adding the <code>sex</code> term provides a better fit relative to <code>mental rotation ~ contrast</code> alone.</p>
<div id="residuals-based-approach" class="section level2">
<h2>Residuals-based approach</h2>
<p>We’ll take evaluate the first approach using residuals.</p>
<div id="contrast" class="section level3">
<h3>Contrast</h3>
<p>Focus on the log contrast sensitivity threshold data.</p>
<pre class="r"><code># Select relevant data from data frame.
df_mr_log_contr &lt;- df_complete2 %&gt;%
  dplyr::select(., Sex, log_contrast, mental_rot)</code></pre>
<p>Visualize mental rotation scores.</p>
<pre class="r"><code>df_mr_log_contr %&gt;%
  ggplot(.) +
  aes(Sex, mental_rot, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>t.test(
  mental_rot ~ Sex,
  data = df_complete2,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mental_rot by Sex
## t = -2, df = 118, p-value = 0.008
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##   -Inf -0.99
## sample estimates:
## mean in group Females   mean in group Males 
##                    27                    30</code></pre>
<p>Mental rotation scores differ between males and females.</p>
<p>Fit <code>mental_rot ~ log_contrast</code>.</p>
<pre class="r"><code>lm_mr_log_contr &lt;- lm(mental_rot ~ log_contrast, df_mr_log_contr)
summary(lm_mr_log_contr)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast, data = df_mr_log_contr)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.703  -3.426  -0.369   3.758  12.739 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)      8.55       6.07    1.41   0.1614   
## log_contrast   -10.55       3.41   -3.10   0.0025 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 118 degrees of freedom
## Multiple R-squared:  0.0751, Adjusted R-squared:  0.0673 
## F-statistic: 9.58 on 1 and 118 DF,  p-value: 0.00245</code></pre>
<p>Extract the residuals and fit <code>mr_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_mr_log_contr)
df_mr_resids &lt;- data.frame(mr_resids = resids, Sex = df_mr_log_contr$Sex)
lm_mr_resids_sex &lt;- lm(mr_resids ~ Sex, df_mr_resids)
summary(lm_mr_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mr_resids ~ Sex, data = df_mr_resids)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.501  -3.946  -0.258   4.085  13.222 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   -0.483      0.604   -0.80     0.43
## SexMales       2.069      1.251    1.65     0.10
## 
## Residual standard error: 5.8 on 118 degrees of freedom
## Multiple R-squared:  0.0227, Adjusted R-squared:  0.0144 
## F-statistic: 2.74 on 1 and 118 DF,  p-value: 0.101</code></pre>
<p>Plot to visualize.</p>
<pre class="r"><code>df_mr_resids %&gt;%
  ggplot(.) +
  aes(Sex, mr_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>Test for differences in means.</p>
<pre class="r"><code>t.test(
  mr_resids ~ Sex,
  data = df_mr_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mr_resids by Sex
## t = -2, df = 118, p-value = 0.05
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##   -Inf 0.004
## sample estimates:
## mean in group Females   mean in group Males 
##                 -0.48                  1.59</code></pre>
<p>So, including contrast sensitivity reduces, but does not eliminate, a statistically significant difference in mental rotation scores by sex favoring men.</p>
</div>
<div id="motion" class="section level3">
<h3>Motion</h3>
<pre class="r"><code># Select relevant data from data frame.
df_mr_log_motion &lt;- df_complete2 %&gt;%
  dplyr::select(., Sex, log_motion, mental_rot)</code></pre>
<p>Fit <code>mental_rot ~ log_cmotion</code>.</p>
<pre class="r"><code>lm_mr_log_motion &lt;- lm(mental_rot ~ log_motion, df_mr_log_motion)
summary(lm_mr_log_motion)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion, data = df_mr_log_motion)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.124  -3.974  -0.552   3.678  12.010 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)     9.19       6.18    1.49   0.1397   
## log_motion     -7.70       2.63   -2.93   0.0041 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 118 degrees of freedom
## Multiple R-squared:  0.0679, Adjusted R-squared:  0.06 
## F-statistic: 8.59 on 1 and 118 DF,  p-value: 0.00405</code></pre>
<p>Extract the residuals and fit <code>mr_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_mr_log_motion)
df_mr_resids &lt;- data.frame(mr_resids = resids, Sex = df_mr_log_motion$Sex)
lm_mr_resids_sex &lt;- lm(mr_resids ~ Sex, df_mr_resids)
summary(lm_mr_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mr_resids ~ Sex, data = df_mr_resids)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.778  -4.042  -0.422   3.949  12.357 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)   -0.347      0.610   -0.57     0.57
## SexMales       1.486      1.263    1.18     0.24
## 
## Residual standard error: 5.8 on 118 degrees of freedom
## Multiple R-squared:  0.0116, Adjusted R-squared:  0.00323 
## F-statistic: 1.39 on 1 and 118 DF,  p-value: 0.242</code></pre>
<p>Plot to visualize.</p>
<pre class="r"><code>df_mr_resids %&gt;%
  ggplot(.) +
  aes(Sex, mr_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Test for mean differences.</p>
<pre class="r"><code>t.test(
  mr_resids ~ Sex,
  data = df_mr_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  mr_resids by Sex
## t = -1, df = 118, p-value = 0.1
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##  -Inf 0.61
## sample estimates:
## mean in group Females   mean in group Males 
##                 -0.35                  1.14</code></pre>
<p>So, including motion eliminates a statistically significant difference in mental rotation scores by sex favoring men.</p>
</div>
</div>
<div id="combining-vision-measures" class="section level2">
<h2>Combining vision measures</h2>
<p>Let’s see whether combining the vision measures can do even better in accounting for mental rotation.</p>
<pre class="r"><code>df_mr_contr_motion &lt;- df_complete2 %&gt;%
  dplyr::select(., Sex, log_contrast, log_motion, mental_rot)</code></pre>
<p>Full model.</p>
<pre class="r"><code>lm_mr_contr_motion_full &lt;- lm(mental_rot ~ log_contrast*log_motion*Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_full)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast * log_motion * Sex, data = df_mr_contr_motion)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.332  -4.113  -0.189   3.575  11.925 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)                        -19.32      61.45   -0.31     0.75
## log_contrast                       -16.04      36.02   -0.45     0.66
## log_motion                         -14.67      27.23   -0.54     0.59
## SexMales                            80.18     401.27    0.20     0.84
## log_contrast:log_motion             -3.95      15.89   -0.25     0.80
## log_contrast:SexMales               23.44     215.65    0.11     0.91
## log_motion:SexMales                 31.45     157.40    0.20     0.84
## log_contrast:log_motion:SexMales     9.25      84.73    0.11     0.91
## 
## Residual standard error: 5.8 on 112 degrees of freedom
## Multiple R-squared:  0.152,  Adjusted R-squared:  0.0986 
## F-statistic: 2.86 on 7 and 112 DF,  p-value: 0.00876</code></pre>
<p>Drop interactions.</p>
<pre class="r"><code>lm_mr_contr_motion_no_interactions &lt;- lm(mental_rot ~ log_contrast + log_motion + Sex, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_interactions)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion + Sex, data = df_mr_contr_motion)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.883  -4.110  -0.285   3.743  12.381 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     0.777      8.402    0.09    0.926  
## log_contrast   -8.051      3.514   -2.29    0.024 *
## log_motion     -5.077      2.893   -1.75    0.082 .
## SexMales        1.240      1.409    0.88    0.381  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.8 on 116 degrees of freedom
## Multiple R-squared:  0.121,  Adjusted R-squared:  0.0983 
## F-statistic: 5.33 on 3 and 116 DF,  p-value: 0.00179</code></pre>
<p>Drop sex.</p>
<pre class="r"><code>lm_mr_contr_motion_no_sex &lt;- lm(mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
summary(lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + log_motion, data = df_mr_contr_motion)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.313  -4.240  -0.394   3.606  11.960 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     -2.35       7.61   -0.31    0.758  
## log_contrast    -8.63       3.45   -2.50    0.014 *
## log_motion      -6.10       2.65   -2.30    0.023 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.8 on 117 degrees of freedom
## Multiple R-squared:  0.115,  Adjusted R-squared:   0.1 
## F-statistic: 7.62 on 2 and 117 DF,  p-value: 0.000777</code></pre>
<p>Compare models.</p>
<pre class="r"><code>anova(lm_mr_contr_motion_no_sex, lm_mr_contr_motion_no_interactions)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ log_contrast + log_motion
## Model 2: mental_rot ~ log_contrast + log_motion + Sex
##   Res.Df  RSS Df Sum of Sq    F Pr(&gt;F)
## 1    117 3878                         
## 2    116 3852  1      25.7 0.77   0.38</code></pre>
<p>So, the RSS down a bit, but not significantly. All things being equal, we’d choose the simpler model for parsimony reasons.</p>
<pre class="r"><code>lm_mr_only_sex &lt;- lm(mental_rot ~ Sex, data = df_mr_contr_motion)
summary(lm_mr_only_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ Sex, data = df_mr_contr_motion)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.643  -3.643   0.357   3.478  13.478 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    26.52       0.62   42.78   &lt;2e-16 ***
## SexMales        3.12       1.28    2.43    0.017 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 118 degrees of freedom
## Multiple R-squared:  0.0477, Adjusted R-squared:  0.0396 
## F-statistic: 5.91 on 1 and 118 DF,  p-value: 0.0165</code></pre>
<p>Comparing models.</p>
<pre class="r"><code>anova(lm_mr_only_sex, lm_mr_contr_motion_no_sex)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: mental_rot ~ Sex
## Model 2: mental_rot ~ log_contrast + log_motion
##   Res.Df  RSS Df Sum of Sq    F Pr(&gt;F)   
## 1    118 4173                            
## 2    117 3878  1       296 8.92 0.0034 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The model with the smaller RSS is the one with the vision variables. And the .</p>
</div>
</div>
<div id="does-vision-account-for-hobby-choices" class="section level1">
<h1>Does vision account for hobby choices?</h1>
<p>We’ll take the same approach as above.</p>
<div id="feminine-hobbies-1" class="section level2">
<h2>Feminine hobbies</h2>
<div id="contrast-1" class="section level3">
<h3>Contrast</h3>
<pre class="r"><code>df_complete2 %&gt;%
  ggplot(.) +
  aes(Sex, femscale, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Fit <code>femscale ~ log_contrast</code>.</p>
<pre class="r"><code>lm_femscale_log_contr &lt;- lm(femscale ~ log_contrast, df_complete2)
summary(lm_femscale_log_contr)</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ log_contrast, data = df_complete2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.217 -0.177  0.044  0.251  0.764 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     1.410      0.332    4.24  4.4e-05 ***
## log_contrast    0.704      0.187    3.77  0.00025 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.32 on 118 degrees of freedom
## Multiple R-squared:  0.108,  Adjusted R-squared:   0.1 
## F-statistic: 14.2 on 1 and 118 DF,  p-value: 0.000255</code></pre>
<p>Extract the residuals and fit <code>femscale_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_femscale_log_contr)
df_femscale_resids &lt;- data.frame(femscale_resids = resids, Sex = df_complete2$Sex)
lm_femscale_resids_sex &lt;- lm(femscale_resids ~ Sex, df_femscale_resids)
summary(lm_femscale_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale_resids ~ Sex, data = df_femscale_resids)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8894 -0.1913  0.0103  0.1905  0.6644 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.0997     0.0275    3.62  0.00044 ***
## SexMales     -0.4273     0.0570   -7.49  1.3e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.26 on 118 degrees of freedom
## Multiple R-squared:  0.322,  Adjusted R-squared:  0.317 
## F-statistic: 56.2 on 1 and 118 DF,  p-value: 1.34e-11</code></pre>
<p>Plot to visualize.</p>
<pre class="r"><code>df_femscale_resids %&gt;%
  ggplot(.) +
  aes(Sex, femscale_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Test for mean differences.</p>
<pre class="r"><code>t.test(
  femscale_resids ~ Sex,
  data = df_femscale_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  femscale_resids by Sex
## t = 7, df = 118, p-value = 1
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##  -Inf 0.52
## sample estimates:
## mean in group Females   mean in group Males 
##                  0.10                 -0.33</code></pre>
<p>Accounting for <code>log_contrast</code> does NOT eliminate the sex difference in <code>femscale</code>.</p>
<p><strong>NB: This workflow should be packaged in a function to reduce the likelihood of errors.</strong></p>
</div>
<div id="motion-1" class="section level3">
<h3>Motion</h3>
<p>Fit <code>femscale ~ log_motion</code>.</p>
<pre class="r"><code>lm_femscale_log_motion &lt;- lm(femscale ~ log_motion, df_complete2)
summary(lm_femscale_log_motion)</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ log_motion, data = df_complete2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.2584 -0.1686  0.0249  0.2089  0.6885 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    1.587      0.332    4.78  5.0e-06 ***
## log_motion     0.608      0.141    4.31  3.4e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.32 on 118 degrees of freedom
## Multiple R-squared:  0.136,  Adjusted R-squared:  0.129 
## F-statistic: 18.6 on 1 and 118 DF,  p-value: 3.38e-05</code></pre>
<p>Extract the residuals and fit <code>femscale_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_femscale_log_motion)
df_femscale_resids &lt;- data.frame(femscale_resids = resids, Sex = df_complete2$Sex)
lm_femscale_resids_sex &lt;- lm(femscale_resids ~ Sex, df_femscale_resids)
summary(lm_femscale_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale_resids ~ Sex, data = df_femscale_resids)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -0.976 -0.163  0.040  0.212  0.603 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.0860     0.0286    3.01   0.0032 ** 
## SexMales     -0.3684     0.0591   -6.23  7.4e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.27 on 118 degrees of freedom
## Multiple R-squared:  0.248,  Adjusted R-squared:  0.241 
## F-statistic: 38.8 on 1 and 118 DF,  p-value: 7.38e-09</code></pre>
<p>Plot to visualize.</p>
<pre class="r"><code>df_femscale_resids %&gt;%
  ggplot(.) +
  aes(Sex, femscale_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Test for mean differences.</p>
<pre class="r"><code>t.test(
  femscale_resids ~ Sex,
  data = df_femscale_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  femscale_resids by Sex
## t = 6, df = 118, p-value = 1
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##  -Inf 0.47
## sample estimates:
## mean in group Females   mean in group Males 
##                 0.086                -0.282</code></pre>
<p>Motion thresholds do <em>not</em> eliminate sex differences in <code>femscale</code>.</p>
</div>
<div id="combining-contrast-and-motion" class="section level3">
<h3>Combining contrast and motion</h3>
<p>For simplicity, we will compare a model with <code>Sex</code> alone to one with both vision measures.</p>
<pre class="r"><code>lm_femscale_vision &lt;- lm(femscale ~ log_contrast + log_motion, df_complete2)
lm_femscale_sex &lt;- lm(femscale ~ Sex, df_complete2)
anova(lm_femscale_sex, lm_femscale_vision)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: femscale ~ Sex
## Model 2: femscale ~ log_contrast + log_motion
##   Res.Df   RSS Df Sum of Sq F Pr(&gt;F)
## 1    118  8.31                      
## 2    117 10.94  1     -2.63</code></pre>
<p>The RSS goes up with the model including the vision measures.</p>
<pre class="r"><code>summary(lm_femscale_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ Sex, data = df_complete2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -0.890 -0.136  0.022  0.174  0.828 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.2780     0.0277   10.05  &lt; 2e-16 ***
## SexMales     -0.4974     0.0573   -8.69  2.5e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.27 on 118 degrees of freedom
## Multiple R-squared:  0.39,   Adjusted R-squared:  0.385 
## F-statistic: 75.5 on 1 and 118 DF,  p-value: 2.49e-14</code></pre>
<p>Vision measures are <em>not</em> a better predictor of <code>femscales</code> than <code>Sex</code> alone.</p>
</div>
</div>
<div id="masculine-hobbies-1" class="section level2">
<h2>Masculine hobbies</h2>
<pre class="r"><code>df_complete2 %&gt;%
  ggplot(.) +
  aes(Sex, masscale, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div id="contrast-2" class="section level3">
<h3>Contrast</h3>
<p>Fit <code>masscale ~ log_contrast</code>.</p>
<pre class="r"><code>lm_masscale_log_contrast &lt;- lm(masscale ~ log_contrast, df_complete2)
summary(lm_masscale_log_contrast)</code></pre>
<pre><code>## 
## Call:
## lm(formula = masscale ~ log_contrast, data = df_complete2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.7122 -0.2322 -0.0621  0.2130  0.8328 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -1.438      0.352   -4.08  8.2e-05 ***
## log_contrast   -0.598      0.198   -3.02   0.0031 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.34 on 118 degrees of freedom
## Multiple R-squared:  0.0718, Adjusted R-squared:  0.064 
## F-statistic: 9.13 on 1 and 118 DF,  p-value: 0.00308</code></pre>
<p>Extract the residuals and fit <code>masscale_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_masscale_log_contrast)
df_masscale_resids &lt;- data.frame(masscale_resids = resids, Sex = df_complete2$Sex)
lm_masscale_resids_sex &lt;- lm(masscale_resids ~ Sex, df_masscale_resids)
summary(lm_masscale_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = masscale_resids ~ Sex, data = df_masscale_resids)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5833 -0.1362 -0.0149  0.1498  0.6802 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.1289     0.0256   -5.03  1.8e-06 ***
## SexMales      0.5525     0.0531   10.41  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.25 on 118 degrees of freedom
## Multiple R-squared:  0.479,  Adjusted R-squared:  0.474 
## F-statistic:  108 on 1 and 118 DF,  p-value: &lt;2e-16</code></pre>
<pre class="r"><code>df_masscale_resids %&gt;%
  ggplot(.) +
  aes(Sex, masscale_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>Test for mean differences.</p>
<pre class="r"><code>t.test(
  masscale_resids ~ Sex,
  data = df_masscale_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  masscale_resids by Sex
## t = -10, df = 118, p-value &lt;2e-16
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##   -Inf -0.46
## sample estimates:
## mean in group Females   mean in group Males 
##                 -0.13                  0.42</code></pre>
<p>Contrast sensitivity does <em>not</em> account for <code>masscale</code>.</p>
</div>
<div id="motion-2" class="section level3">
<h3>Motion</h3>
<p>Fit <code>masscale ~ log_motion</code>.</p>
<pre class="r"><code>lm_masscale_log_motion &lt;- lm(masscale ~ log_motion, df_complete2)
summary(lm_masscale_log_motion)</code></pre>
<pre><code>## 
## Call:
## lm(formula = masscale ~ log_motion, data = df_complete2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.6453 -0.2126 -0.0442  0.1974  0.8916 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -1.681      0.351   -4.78    5e-06 ***
## log_motion    -0.556      0.149   -3.72    3e-04 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.33 on 118 degrees of freedom
## Multiple R-squared:  0.105,  Adjusted R-squared:  0.0976 
## F-statistic: 13.9 on 1 and 118 DF,  p-value: 0.000302</code></pre>
<p>Extract the residuals and fit <code>masscale_resids ~ Sex</code>.</p>
<pre class="r"><code>resids &lt;- resid(lm_masscale_log_motion)
df_masscale_resids &lt;- data.frame(masscale_resids = resids, Sex = df_complete2$Sex)
lm_masscale_resids_sex &lt;- lm(masscale_resids ~ Sex, df_masscale_resids)
summary(lm_masscale_resids_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = masscale_resids ~ Sex, data = df_masscale_resids)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5300 -0.1385 -0.0035  0.1431  0.7359 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.1153     0.0271   -4.26  4.2e-05 ***
## SexMales      0.4941     0.0560    8.82  1.2e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.26 on 118 degrees of freedom
## Multiple R-squared:  0.397,  Adjusted R-squared:  0.392 
## F-statistic: 77.7 on 1 and 118 DF,  p-value: 1.24e-14</code></pre>
<pre class="r"><code>df_masscale_resids %&gt;%
  ggplot(.) +
  aes(Sex, masscale_resids, color = Sex, alpha = 0.3) +
  geom_boxplot() +
  geom_violin() +
  geom_point() +
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="qian-berenbaum-gilmore_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Test for mean differences.</p>
<pre class="r"><code>t.test(
  masscale_resids ~ Sex,
  data = df_masscale_resids,
  var.equal = TRUE,
  alternative = &quot;less&quot;
)</code></pre>
<pre><code>## 
##  Two Sample t-test
## 
## data:  masscale_resids by Sex
## t = -9, df = 118, p-value = 6e-15
## alternative hypothesis: true difference in means between group Females and group Males is less than 0
## 95 percent confidence interval:
##  -Inf -0.4
## sample estimates:
## mean in group Females   mean in group Males 
##                 -0.12                  0.38</code></pre>
<p>Motion sensitivity does <em>not</em> account for <code>masscale</code>.</p>
</div>
<div id="combining-contrast-and-motion-1" class="section level3">
<h3>Combining contrast and motion</h3>
<p>For simplicity, we will compare a model with <code>Sex</code> alone to one with both vision measures.</p>
<pre class="r"><code>lm_masscale_vision &lt;- lm(masscale ~ log_contrast + log_motion, df_complete2)
lm_masscale_sex &lt;- lm(masscale ~ Sex, df_complete2)
anova(lm_masscale_sex, lm_masscale_vision)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: masscale ~ Sex
## Model 2: masscale ~ log_contrast + log_motion
##   Res.Df  RSS Df Sum of Sq F Pr(&gt;F)
## 1    118  6.7                      
## 2    117 12.6  1     -5.93</code></pre>
<p>The RSS goes <em>up</em> with the more complex model. The increase is not statistically significant, and so we choose the simpler model with <code>Sex</code> alone.</p>
<pre class="r"><code>summary(lm_masscale_vision)</code></pre>
<pre><code>## 
## Call:
## lm(formula = masscale ~ log_contrast + log_motion, data = df_complete2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.6364 -0.2156 -0.0415  0.2072  0.8481 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -2.282      0.434   -5.26  6.7e-07 ***
## log_contrast   -0.449      0.197   -2.28   0.0242 *  
## log_motion     -0.472      0.151   -3.13   0.0022 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.33 on 117 degrees of freedom
## Multiple R-squared:  0.143,  Adjusted R-squared:  0.129 
## F-statistic: 9.79 on 2 and 117 DF,  p-value: 0.000117</code></pre>
<pre class="r"><code>summary(lm_masscale_sex)</code></pre>
<pre><code>## 
## Call:
## lm(formula = masscale ~ Sex, data = df_complete2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.5608 -0.1360 -0.0026  0.1297  0.6582 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -0.5201     0.0249   -20.9   &lt;2e-16 ***
## SexMales      0.6122     0.0514    11.9   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.24 on 118 degrees of freedom
## Multiple R-squared:  0.545,  Adjusted R-squared:  0.542 
## F-statistic:  142 on 1 and 118 DF,  p-value: &lt;2e-16</code></pre>
<p>Again, <code>Sex</code> is a better predictor of <code>masscale</code> than the combined vision measures.</p>
</div>
</div>
</div>
<div id="mediation-analysis" class="section level1">
<h1>Mediation analysis</h1>
<p>The following reference may be useful for some (it was for ROG):</p>
<p><a href="https://towardsdatascience.com/doing-and-reporting-your-first-mediation-analysis-in-r-2fe423b92171" class="uri">https://towardsdatascience.com/doing-and-reporting-your-first-mediation-analysis-in-r-2fe423b92171</a></p>
<pre class="r"><code>library(mediation)</code></pre>
<div id="feminine_hobbies---motion_dur_thr---mental_rot" class="section level3">
<h3>Feminine_hobbies -&gt; motion_dur_thr -&gt; mental_rot</h3>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect = lm(mental_rot ~ femscale + vocab + Sex, df2)
summary(fit.totaleffect) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + vocab + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.744  -4.400  -0.188   4.645  12.899 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  27.2477     1.3814   19.72   &lt;2e-16 ***
## femscale     -2.9778     2.0837   -1.43     0.16    
## vocab        -0.0228     0.1115   -0.20     0.84    
## SexMales      1.9894     1.6276    1.22     0.22    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 127 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.0702, Adjusted R-squared:  0.0483 
## F-statistic:  3.2 on 3 and 127 DF,  p-value: 0.0257</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator = lm(log_motion ~ femscale + Sex, df2)
summary(fit.mediator) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_motion ~ femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4422 -0.1375 -0.0286  0.0891  0.8020 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -2.3211     0.0291  -79.90   &lt;2e-16 ***
## femscale      0.0930     0.0709    1.31    0.192    
## SexMales     -0.1134     0.0559   -2.03    0.045 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.21 on 122 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.112,  Adjusted R-squared:  0.0978 
## F-statistic: 7.72 on 2 and 122 DF,  p-value: 0.000695</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv = lm(mental_rot ~ log_motion + femscale + vocab + Sex, df2)
summary(fit.dv) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion + femscale + vocab + Sex, 
##     data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.264  -4.181  -0.148   4.234  13.023 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   17.358      6.066    2.86    0.005 **
## log_motion    -4.566      2.630   -1.74    0.085 . 
## femscale      -3.151      2.054   -1.53    0.128   
## vocab         -0.049      0.113   -0.43    0.665   
## SexMales       0.892      1.628    0.55    0.585   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 120 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.0943, Adjusted R-squared:  0.0641 
## F-statistic: 3.12 on 4 and 120 DF,  p-value: 0.0174</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results = mediate(
  fit.mediator,
  fit.dv,
  treat = &#39;femscale&#39;,
  mediator =
    &#39;log_motion&#39;,
  boot = T
) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value
## ACME             -0.425       -1.265         0.36    0.32
## ADE              -3.151       -7.914         1.02    0.15
## Total Effect     -3.576       -8.303         1.00    0.13
## Prop. Mediated    0.119       -0.505         0.55    0.38
## 
## Sample Size Used: 125 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code># not significant ACME is boot=T</code></pre>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect = lm(mental_rot ~ femscale + Sex, df2)
summary(fit.totaleffect) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.649  -4.426  -0.073   4.659  12.926 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    27.02       0.83   32.55   &lt;2e-16 ***
## femscale       -2.92       2.06   -1.42     0.16    
## SexMales        2.00       1.62    1.24     0.22    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 128 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.0699, Adjusted R-squared:  0.0554 
## F-statistic: 4.81 on 2 and 128 DF,  p-value: 0.00965</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator = lm(log_motion ~ femscale + Sex, df2)
summary(fit.mediator) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_motion ~ femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4422 -0.1375 -0.0286  0.0891  0.8020 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -2.3211     0.0291  -79.90   &lt;2e-16 ***
## femscale      0.0930     0.0709    1.31    0.192    
## SexMales     -0.1134     0.0559   -2.03    0.045 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.21 on 122 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.112,  Adjusted R-squared:  0.0978 
## F-statistic: 7.72 on 2 and 122 DF,  p-value: 0.000695</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv = lm(mental_rot ~ log_motion + femscale + Sex, df2)
summary(fit.dv) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion + femscale + Sex, data = df2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -12.62  -4.32  -0.09   4.33  12.96 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   17.344      6.046    2.87   0.0049 **
## log_motion    -4.365      2.580   -1.69   0.0932 . 
## femscale      -3.052      2.034   -1.50   0.1361   
## SexMales       0.934      1.620    0.58   0.5652   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 121 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.0929, Adjusted R-squared:  0.0704 
## F-statistic: 4.13 on 3 and 121 DF,  p-value: 0.00793</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results = mediate(
  fit.mediator,
  fit.dv,
  treat = &#39;femscale&#39;,
  mediator =
    &#39;log_motion&#39;,
  boot = T
) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value
## ACME             -0.406       -1.232         0.39    0.32
## ADE              -3.052       -7.732         1.15    0.15
## Total Effect     -3.458       -8.187         1.08    0.13
## Prop. Mediated    0.117       -0.522         0.58    0.37
## 
## Sample Size Used: 125 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code># not significant ACME is boot=T</code></pre>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect3 = lm(mental_rot ~ femscale, df_complete_F)
summary(fit.totaleffect3) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.432  -4.481   0.374   4.464  11.524 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   28.512      0.873    32.7   &lt;2e-16 ***
## femscale      -7.161      2.308    -3.1   0.0026 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.7 on 90 degrees of freedom
## Multiple R-squared:  0.0966, Adjusted R-squared:  0.0866 
## F-statistic: 9.63 on 1 and 90 DF,  p-value: 0.00256</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator3 = lm(log_motion ~ femscale, df_complete_F)
summary(fit.mediator3) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_motion ~ femscale, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4443 -0.1181 -0.0332  0.0837  0.6650 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -2.3402     0.0287  -81.55   &lt;2e-16 ***
## femscale      0.1602     0.0759    2.11    0.037 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.19 on 90 degrees of freedom
## Multiple R-squared:  0.0472, Adjusted R-squared:  0.0366 
## F-statistic: 4.46 on 1 and 90 DF,  p-value: 0.0375</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv3 = lm(mental_rot ~ log_motion + femscale, df_complete_F)
summary(fit.dv3) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion + femscale, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.492  -3.877   0.359   3.640  11.566 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)    11.14       7.37    1.51    0.134  
## log_motion     -7.43       3.13   -2.37    0.020 *
## femscale       -5.97       2.31   -2.59    0.011 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.5 on 89 degrees of freedom
## Multiple R-squared:  0.15,   Adjusted R-squared:  0.131 
## F-statistic: 7.88 on 2 and 89 DF,  p-value: 0.000707</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results3 = mediate(
  fit.mediator3,
  fit.dv3,
  treat = &#39;femscale&#39;,
  mediator =
    &#39;log_motion&#39;,
  boot = T
) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results3)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value   
## ACME            -1.1896      -2.3367         0.19   0.112   
## ADE             -5.9716     -10.9370        -1.41   0.014 * 
## Total Effect    -7.1612     -11.9705        -2.23   0.008 **
## Prop. Mediated   0.1661      -0.0471         0.44   0.116   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 92 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code># not significant ACME is boot=T</code></pre>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect4 = lm(mental_rot ~ femscale + vocab, df_complete_F)
summary(fit.totaleffect4) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + vocab, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.729  -4.431   0.275   4.391  11.700 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  28.1430     1.5381   18.30   &lt;2e-16 ***
## femscale     -7.0668     2.3424   -3.02   0.0033 ** 
## vocab         0.0378     0.1294    0.29   0.7707    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.7 on 89 degrees of freedom
## Multiple R-squared:  0.0975, Adjusted R-squared:  0.0772 
## F-statistic: 4.81 on 2 and 89 DF,  p-value: 0.0104</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator4 = lm(log_motion ~ femscale, df_complete_F)
summary(fit.mediator4) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_motion ~ femscale, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.4443 -0.1181 -0.0332  0.0837  0.6650 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -2.3402     0.0287  -81.55   &lt;2e-16 ***
## femscale      0.1602     0.0759    2.11    0.037 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.19 on 90 degrees of freedom
## Multiple R-squared:  0.0472, Adjusted R-squared:  0.0366 
## F-statistic: 4.46 on 1 and 90 DF,  p-value: 0.0375</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv4 = lm(mental_rot ~ log_motion + femscale + vocab, df_complete_F)
summary(fit.dv4) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion + femscale + vocab, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.421  -3.856   0.318   3.668  11.521 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 11.14043    7.40973    1.50    0.136  
## log_motion  -7.46373    3.18529   -2.34    0.021 *
## femscale    -5.98966    2.33127   -2.57    0.012 *
## vocab       -0.00971    0.12784   -0.08    0.940  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.6 on 88 degrees of freedom
## Multiple R-squared:  0.15,   Adjusted R-squared:  0.122 
## F-statistic:  5.2 on 3 and 88 DF,  p-value: 0.00237</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results4 = mediate(
  fit.mediator4,
  fit.dv4,
  treat = &#39;femscale&#39;,
  mediator =
    &#39;log_motion&#39;,
  boot = T
) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results4)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value  
## ACME            -1.1958      -2.3508         0.34   0.108  
## ADE             -5.9897     -11.0340        -1.46   0.020 *
## Total Effect    -7.1854     -12.2593        -1.92   0.014 *
## Prop. Mediated   0.1664      -0.0571         0.39   0.118  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 92 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code># not significant ACME is boot=T</code></pre>
</div>
<div id="feminine_hobbies--contrast-mental_rot" class="section level3">
<h3>Feminine_hobbies -&gt;contrast-&gt;mental_rot</h3>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect = lm(mental_rot ~ femscale + vocab + Sex, df_complete)
summary(fit.totaleffect) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + vocab + Sex, data = df_complete)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.790  -4.323   0.051   4.567  12.436 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  27.6926     1.3992   19.79   &lt;2e-16 ***
## femscale     -3.5040     2.0904   -1.68    0.096 .  
## vocab        -0.0217     0.1136   -0.19    0.849    
## SexMales      1.4181     1.6283    0.87    0.386    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 118 degrees of freedom
## Multiple R-squared:  0.0712, Adjusted R-squared:  0.0476 
## F-statistic: 3.02 on 3 and 118 DF,  p-value: 0.0328</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator = lm(log_contrast ~ femscale + Sex, df_complete)
summary(fit.mediator) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_contrast ~ femscale + Sex, data = df_complete)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2263 -0.1055 -0.0431  0.0686  0.5506 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.7806     0.0223  -79.91   &lt;2e-16 ***
## femscale      0.1104     0.0543    2.03    0.044 *  
## SexMales     -0.0234     0.0427   -0.55    0.585    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.16 on 119 degrees of freedom
## Multiple R-squared:  0.0757, Adjusted R-squared:  0.0602 
## F-statistic: 4.87 on 2 and 119 DF,  p-value: 0.00925</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv = lm(mental_rot ~ log_contrast + femscale + vocab + Sex, df_complete)
summary(fit.dv) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + femscale + vocab + Sex, 
##     data = df_complete)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.498  -3.494  -0.451   4.664  12.486 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   12.4380     6.1746    2.01    0.046 *
## log_contrast  -8.6747     3.4240   -2.53    0.013 *
## femscale      -2.5974     2.0750   -1.25    0.213  
## vocab         -0.0413     0.1113   -0.37    0.711  
## SexMales       1.2068     1.5943    0.76    0.451  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 117 degrees of freedom
## Multiple R-squared:  0.12,   Adjusted R-squared:  0.0894 
## F-statistic: 3.97 on 4 and 117 DF,  p-value: 0.00467</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results = mediate(
  fit.mediator,
  fit.dv,
  treat = &#39;femscale&#39;,
  mediator =
    &#39;log_contrast&#39;,
  boot = T
) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value  
## ACME             -0.957       -1.961        -0.09   0.022 *
## ADE              -2.597       -7.279         1.61   0.218  
## Total Effect     -3.555       -8.416         0.92   0.118  
## Prop. Mediated    0.269       -0.783         1.88   0.140  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 122 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code>summary(lm(mental_rot ~ log_contrast + vocab + Sex, df_complete))</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + vocab + Sex, data = df_complete)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.609  -3.821  -0.308   4.241  13.242 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   10.2628     5.9393    1.73   0.0866 . 
## log_contrast  -9.4138     3.3808   -2.78   0.0062 **
## vocab         -0.0237     0.1107   -0.21   0.8312   
## SexMales       2.4276     1.2642    1.92   0.0572 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 118 degrees of freedom
## Multiple R-squared:  0.108,  Adjusted R-squared:  0.085 
## F-statistic: 4.75 on 3 and 118 DF,  p-value: 0.00366</code></pre>
<pre class="r"><code># summary(lm(mental_rot ~ log_contrast +Sex, df2))
# significant ACME </code></pre>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect = lm(mental_rot ~ femscale + vocab + Sex, df2)
summary(fit.totaleffect) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + vocab + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.744  -4.400  -0.188   4.645  12.899 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  27.2477     1.3814   19.72   &lt;2e-16 ***
## femscale     -2.9778     2.0837   -1.43     0.16    
## vocab        -0.0228     0.1115   -0.20     0.84    
## SexMales      1.9894     1.6276    1.22     0.22    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 127 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.0702, Adjusted R-squared:  0.0483 
## F-statistic:  3.2 on 3 and 127 DF,  p-value: 0.0257</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator = lm(log_contrast ~ femscale + Sex, df2)
summary(fit.mediator) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_contrast ~ femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2216 -0.1053 -0.0432  0.0598  0.5499 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.7830     0.0217  -82.27   &lt;2e-16 ***
## femscale      0.1065     0.0534    1.99    0.048 *  
## SexMales     -0.0219     0.0420   -0.52    0.603    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.16 on 124 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.0696, Adjusted R-squared:  0.0546 
## F-statistic: 4.64 on 2 and 124 DF,  p-value: 0.0114</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv = lm(mental_rot ~ log_contrast + femscale + vocab + Sex, df2)
summary(fit.dv) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + femscale + vocab + Sex, 
##     data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.496  -4.256  -0.284   4.546  12.754 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   11.8931     6.1445    1.94   0.0552 . 
## log_contrast  -9.0002     3.4051   -2.64   0.0093 **
## femscale      -2.3563     2.0714   -1.14   0.2575   
## vocab         -0.0751     0.1100   -0.68   0.4964   
## SexMales       1.5447     1.5919    0.97   0.3338   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 122 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.122,  Adjusted R-squared:  0.0932 
## F-statistic: 4.24 on 4 and 122 DF,  p-value: 0.00302</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results = mediate(
  fit.mediator,
  fit.dv,
  treat = &#39;femscale&#39;,
  mediator =
    &#39;log_contrast&#39;,
  boot = T
) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value  
## ACME             -0.958       -1.940        -0.07   0.034 *
## ADE              -2.356       -7.201         2.30   0.296  
## Total Effect     -3.314       -8.203         1.46   0.176  
## Prop. Mediated    0.289       -1.226         2.12   0.178  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 127 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code>summary(lm(mental_rot ~ log_contrast + vocab + Sex, df2))</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + vocab + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.594  -3.880  -0.374   4.351  13.444 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    9.9675     5.9138    1.69   0.0944 . 
## log_contrast  -9.6352     3.3631   -2.87   0.0049 **
## vocab         -0.0579     0.1091   -0.53   0.5967   
## SexMales       2.6575     1.2574    2.11   0.0366 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 123 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.113,  Adjusted R-squared:  0.091 
## F-statistic: 5.21 on 3 and 123 DF,  p-value: 0.00203</code></pre>
<pre class="r"><code># summary(lm(mental_rot ~ log_contrast +Sex, df2))
# significant ACME </code></pre>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect8 = lm(mental_rot ~ femscale+Sex, df2)
summary(fit.totaleffect8) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.649  -4.426  -0.073   4.659  12.926 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    27.02       0.83   32.55   &lt;2e-16 ***
## femscale       -2.92       2.06   -1.42     0.16    
## SexMales        2.00       1.62    1.24     0.22    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 128 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.0699, Adjusted R-squared:  0.0554 
## F-statistic: 4.81 on 2 and 128 DF,  p-value: 0.00965</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator8 = lm(log_contrast ~ femscale+Sex, df2)
summary(fit.mediator8) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_contrast ~ femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2216 -0.1053 -0.0432  0.0598  0.5499 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.7830     0.0217  -82.27   &lt;2e-16 ***
## femscale      0.1065     0.0534    1.99    0.048 *  
## SexMales     -0.0219     0.0420   -0.52    0.603    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.16 on 124 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.0696, Adjusted R-squared:  0.0546 
## F-statistic: 4.64 on 2 and 124 DF,  p-value: 0.0114</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv8 = lm(mental_rot ~ log_contrast + femscale+Sex, df2)
summary(fit.dv8) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + femscale + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.561  -4.226  -0.327   4.842  12.848 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)     11.45       6.10    1.88    0.063 .
## log_contrast    -8.83       3.39   -2.61    0.010 *
## femscale        -2.16       2.05   -1.06    0.293  
## SexMales         1.60       1.59    1.01    0.315  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 123 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.119,  Adjusted R-squared:  0.0971 
## F-statistic: 5.52 on 3 and 123 DF,  p-value: 0.00137</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results8 = mediate(fit.mediator8, fit.dv8, treat = &#39;femscale&#39;, mediator =
                    &#39;log_contrast&#39;, boot=T) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results8)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value  
## ACME             -0.940       -1.951        -0.04   0.034 *
## ADE              -2.162       -6.800         2.02   0.350  
## Total Effect     -3.102       -7.835         1.66   0.210  
## Prop. Mediated    0.303       -2.241         2.00   0.212  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 127 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code># significant ACME </code></pre>
<pre class="r"><code># Step #1: The total effect
fit.totaleffect = lm(mental_rot ~ femscale+vocab, df_complete_F)
summary(fit.totaleffect) # As you can see, the total effect of f hobbies on our dv is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + vocab, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.729  -4.431   0.275   4.391  11.700 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  28.1430     1.5381   18.30   &lt;2e-16 ***
## femscale     -7.0668     2.3424   -3.02   0.0033 ** 
## vocab         0.0378     0.1294    0.29   0.7707    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.7 on 89 degrees of freedom
## Multiple R-squared:  0.0975, Adjusted R-squared:  0.0772 
## F-statistic: 4.81 on 2 and 89 DF,  p-value: 0.0104</code></pre>
<pre class="r"><code># Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator = lm(log_contrast ~ femscale,df_complete_F)
summary(fit.mediator) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_contrast ~ femscale, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2430 -0.1193 -0.0456  0.0967  0.4058 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.7957     0.0250  -71.88   &lt;2e-16 ***
## femscale      0.1647     0.0661    2.49    0.014 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.16 on 90 degrees of freedom
## Multiple R-squared:  0.0646, Adjusted R-squared:  0.0542 
## F-statistic: 6.21 on 1 and 90 DF,  p-value: 0.0145</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv = lm(mental_rot ~ log_contrast + femscale+vocab, df_complete_F)
summary(fit.dv) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + femscale + vocab, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.970  -3.810   0.066   4.052  11.553 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   16.5463     6.7099    2.47    0.016 *
## log_contrast  -6.4946     3.6601   -1.77    0.079 .
## femscale      -6.0141     2.3895   -2.52    0.014 *
## vocab          0.0311     0.1279    0.24    0.809  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.6 on 88 degrees of freedom
## Multiple R-squared:  0.129,  Adjusted R-squared:  0.099 
## F-statistic: 4.33 on 3 and 88 DF,  p-value: 0.00677</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results = mediate(fit.mediator, fit.dv, treat = &#39;femscale&#39;, mediator =
                    &#39;log_contrast&#39;, boot=T) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value   
## ACME            -1.0694      -2.5242         0.05   0.058 . 
## ADE             -6.0141     -10.9751        -1.03   0.016 * 
## Total Effect    -7.0836     -11.8238        -2.00   0.010 **
## Prop. Mediated   0.1510      -0.0185         0.50   0.068 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 92 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code>summary(lm(mental_rot ~ log_contrast +vocab, df_complete_F))</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + vocab, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.690  -3.755  -0.171   4.022  13.288 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   10.5040     6.4508    1.63    0.107  
## log_contrast  -8.7817     3.6503   -2.41    0.018 *
## vocab          0.0717     0.1306    0.55    0.584  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.8 on 89 degrees of freedom
## Multiple R-squared:  0.0659, Adjusted R-squared:  0.0449 
## F-statistic: 3.14 on 2 and 89 DF,  p-value: 0.0481</code></pre>
<pre class="r"><code># summary(lm(mental_rot ~ log_contrast +Sex, df2))
# significant ACME </code></pre>
<pre class="r"><code># Step #1: The total effect
# Step #2: The effect of the IV onto the mediator
# To establish any mediation, the independent variable (iv, “sepal length” in our case) must significantly affect the mediator. This is logical as, without any effect here, no mediation can take place.
fit.mediator5 = lm(log_contrast ~ femscale, df_complete_F)
summary(fit.mediator5) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = log_contrast ~ femscale, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.2430 -0.1193 -0.0456  0.0967  0.4058 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -1.7957     0.0250  -71.88   &lt;2e-16 ***
## femscale      0.1647     0.0661    2.49    0.014 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.16 on 90 degrees of freedom
## Multiple R-squared:  0.0646, Adjusted R-squared:  0.0542 
## F-statistic: 6.21 on 1 and 90 DF,  p-value: 0.0145</code></pre>
<pre class="r"><code># Step #3: The effect of the mediator on the dependent variable
fit.dv5 = lm(mental_rot ~ log_contrast + femscale+vocab, df_complete_F)
summary(fit.dv5) # The mediator has a significant effect (p&lt;.05) on the dv.</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + femscale + vocab, data = df_complete_F)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.970  -3.810   0.066   4.052  11.553 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)   16.5463     6.7099    2.47    0.016 *
## log_contrast  -6.4946     3.6601   -1.77    0.079 .
## femscale      -6.0141     2.3895   -2.52    0.014 *
## vocab          0.0311     0.1279    0.24    0.809  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.6 on 88 degrees of freedom
## Multiple R-squared:  0.129,  Adjusted R-squared:  0.099 
## F-statistic: 4.33 on 3 and 88 DF,  p-value: 0.00677</code></pre>
<pre class="r"><code># Step #4: Causal Mediation Analysis
results5 = mediate(fit.mediator5, fit.dv5, treat = &#39;femscale&#39;, mediator =
                    &#39;log_contrast&#39;, boot=T) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results5)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value   
## ACME            -1.0694      -2.3586         0.10   0.074 . 
## ADE             -6.0141     -11.0621        -1.14   0.012 * 
## Total Effect    -7.0836     -11.9790        -2.18   0.002 **
## Prop. Mediated   0.1510      -0.0201         0.51   0.076 . 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 92 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code># not significant ACME is boot=T</code></pre>
<blockquote>
<blockquote>
<p>ACME stands for average causal mediation effects. This is the indirect effect of the IV (sepal length) on the DV (likelihood of pollination) that goes through the mediator (attractiveness to bee). Note that it estimated this effect to be -.50 — this is exactly X (the effect of the IV on the mediator from step #2) times X (the mediator’s effect on the DV from step #3) — so not necessarily new information. However, what is new, is that we now have a confidence interval and significance levels for the entire indirect effect, not only its two parts. This is something we need for reporting the mediation. ADE stands for average direct effects. It describes the direct effect of the IV on the DV. Again — if you’ve been paying attention closely — this is not new information. We have calculated this effect before in step #3: the direct effect of the IV on the DV when controlling for the mediator. Total Effect stands for the total effect (direct + indirect) of the IV on the DV. This also isn’t new information. We calculated this in step #1. We can also get it by simply adding the ACME (.113) and the ADE (.019) to receive the total effect of .13. We also already knew that the total effect was significant from step #1. Prop. Mediated describes the proportion of the effect of the IV on the DV that goes through the mediator. It’s calculated by dividing the ACME (-0.50) by the total effect (-3.41) to receive .14. This piece of information is a nice tidbit but not necessarily the focus of our interest.</p>
</blockquote>
</blockquote>
</div>
<div id="log_motion---feminine_hobbies---mental_rot" class="section level3">
<h3>log_motion -&gt; Feminine_hobbies -&gt; mental_rot</h3>
<pre class="r"><code>fit.t4 = lm(mental_rot ~ log_motion + vocab + Sex, df2)
summary(fit.t4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion + vocab + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.075  -4.059  -0.505   3.901  12.757 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  15.4091     5.9650    2.58    0.011 *
## log_motion   -4.9527     2.6323   -1.88    0.062 .
## vocab        -0.0297     0.1128   -0.26    0.793  
## SexMales      2.3932     1.3088    1.83    0.070 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 121 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.0766, Adjusted R-squared:  0.0537 
## F-statistic: 3.34 on 3 and 121 DF,  p-value: 0.0215</code></pre>
<pre class="r"><code>fit.Y4 = lm(mental_rot ~ femscale + log_motion + vocab + Sex, df2)
summary(fit.Y4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + log_motion + vocab + Sex, 
##     data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.264  -4.181  -0.148   4.234  13.023 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   17.358      6.066    2.86    0.005 **
## femscale      -3.151      2.054   -1.53    0.128   
## log_motion    -4.566      2.630   -1.74    0.085 . 
## vocab         -0.049      0.113   -0.43    0.665   
## SexMales       0.892      1.628    0.55    0.585   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 120 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.0943, Adjusted R-squared:  0.0641 
## F-statistic: 3.12 on 4 and 120 DF,  p-value: 0.0174</code></pre>
<pre class="r"><code>fit.M4 = lm(femscale ~ log_motion + Sex, df2)
summary(fit.M4) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ log_motion + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9027 -0.1425  0.0117  0.1821  0.7697 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.6244     0.2631    2.37    0.019 *  
## log_motion    0.1497     0.1141    1.31    0.192    
## SexMales     -0.4771     0.0577   -8.26    2e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.26 on 122 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.412,  Adjusted R-squared:  0.402 
## F-statistic: 42.7 on 2 and 122 DF,  p-value: 8.85e-15</code></pre>
<pre class="r"><code># gvlma(fit.M)
# Step #3: The effect of the mediator on the dependent variable
# The mediator has a significant effect (p&lt;.05) on the dv.
# Step #4: Causal Mediation Analysis
results6 = mediate(fit.M4,
                   fit.Y4,
                   treat = &#39;log_motion&#39;,
                   mediator = &#39;femscale&#39;,
                   boot = T) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results6)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value
## ACME            -0.4717      -2.6246         0.26    0.31
## ADE             -4.5662     -10.3066         1.80    0.15
## Total Effect    -5.0379     -10.9766         0.80    0.10
## Prop. Mediated   0.0936      -0.5249         1.09    0.38
## 
## Sample Size Used: 125 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code>fit.t4 = lm(mental_rot ~ log_motion + Sex, df2)
summary(fit.t4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_motion + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.295  -4.088  -0.495   3.893  12.722 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)    15.44       5.94    2.60    0.011 *
## log_motion     -4.82       2.58   -1.87    0.064 .
## SexMales        2.39       1.30    1.83    0.069 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 122 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.076,  Adjusted R-squared:  0.0609 
## F-statistic: 5.02 on 2 and 122 DF,  p-value: 0.00804</code></pre>
<pre class="r"><code>fit.Y4 = lm(mental_rot ~ femscale + log_motion + Sex, df2)
summary(fit.Y4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + log_motion + Sex, data = df2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -12.62  -4.32  -0.09   4.33  12.96 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   17.344      6.046    2.87   0.0049 **
## femscale      -3.052      2.034   -1.50   0.1361   
## log_motion    -4.365      2.580   -1.69   0.0932 . 
## SexMales       0.934      1.620    0.58   0.5652   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 121 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.0929, Adjusted R-squared:  0.0704 
## F-statistic: 4.13 on 3 and 121 DF,  p-value: 0.00793</code></pre>
<pre class="r"><code>fit.M4 = lm(femscale ~ log_motion + Sex, df2)
summary(fit.M4) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ log_motion + Sex, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.9027 -0.1425  0.0117  0.1821  0.7697 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   0.6244     0.2631    2.37    0.019 *  
## log_motion    0.1497     0.1141    1.31    0.192    
## SexMales     -0.4771     0.0577   -8.26    2e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.26 on 122 degrees of freedom
##   (7 observations deleted due to missingness)
## Multiple R-squared:  0.412,  Adjusted R-squared:  0.402 
## F-statistic: 42.7 on 2 and 122 DF,  p-value: 8.85e-15</code></pre>
<pre class="r"><code># gvlma(fit.M)
# Step #3: The effect of the mediator on the dependent variable
# The mediator has a significant effect (p&lt;.05) on the dv.
# Step #4: Causal Mediation Analysis
results6 = mediate(fit.M4,
                   fit.Y4,
                   treat = &#39;log_motion&#39;,
                   mediator = &#39;femscale&#39;,
                   boot = T) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results6)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value
## ACME            -0.4567      -2.7400         0.26    0.35
## ADE             -4.3654      -9.4252         1.71    0.17
## Total Effect    -4.8221     -10.2137         0.74    0.12
## Prop. Mediated   0.0947      -0.8132         1.12    0.43
## 
## Sample Size Used: 125 
## 
## 
## Simulations: 1000</code></pre>
</div>
<div id="log_contrast---fem_hobbies---mental_rot" class="section level3">
<h3>log_contrast -&gt; fem_hobbies -&gt; mental_rot</h3>
<pre class="r"><code>fit.T5 = lm(mental_rot ~ log_contrast, df2)
summary(fit.T5)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.608  -3.849  -0.386   3.948  12.847 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)      7.89       5.89    1.34   0.1830   
## log_contrast   -10.86       3.31   -3.28   0.0014 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 125 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.0791, Adjusted R-squared:  0.0717 
## F-statistic: 10.7 on 1 and 125 DF,  p-value: 0.00136</code></pre>
<pre class="r"><code>fit.Y5 = lm(mental_rot ~ femscale + log_contrast, df2)
summary(fit.Y5)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + log_contrast, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.555  -3.892  -0.582   4.907  12.244 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)     11.75       6.09    1.93    0.056 . 
## femscale        -3.43       1.62   -2.12    0.036 * 
## log_contrast    -8.99       3.39   -2.66    0.009 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 124 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.111,  Adjusted R-squared:  0.097 
## F-statistic: 7.77 on 2 and 124 DF,  p-value: 0.000663</code></pre>
<pre class="r"><code>fit.M5 = lm(femscale ~ log_contrast, df2)
summary(fit.M5) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ log_contrast, data = df2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -1.226 -0.178  0.042  0.252  0.808 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     1.124      0.322    3.49  0.00066 ***
## log_contrast    0.544      0.181    3.01  0.00317 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.33 on 125 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.0675, Adjusted R-squared:  0.0601 
## F-statistic: 9.05 on 1 and 125 DF,  p-value: 0.00317</code></pre>
<pre class="r"><code># gvlma(fit.M)
# Step #3: The effect of the mediator on the dependent variable
# The mediator has a significant effect (p&lt;.05) on the dv.
# Step #4: Causal Mediation Analysis
results7 = mediate(fit.M5, fit.Y5, treat = &#39;log_contrast&#39;, mediator = &#39;femscale&#39;) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.
summary(results7)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                 Estimate 95% CI Lower 95% CI Upper p-value    
## ACME            -1.87370     -4.27759         0.02   0.056 .  
## ADE             -9.08326    -15.37582        -2.43   0.008 ** 
## Total Effect   -10.95696    -17.30152        -4.11  &lt;2e-16 ***
## Prop. Mediated   0.16489     -0.00173         0.51   0.056 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 127 
## 
## 
## Simulations: 1000</code></pre>
<pre class="r"><code>summary(lm(mental_rot ~ femscale, df2))</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.111  -4.532   0.049   4.789  12.421 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    27.75       0.59   47.05   &lt;2e-16 ***
## femscale       -4.53       1.59   -2.84   0.0052 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6 on 129 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.0589, Adjusted R-squared:  0.0516 
## F-statistic: 8.07 on 1 and 129 DF,  p-value: 0.00524</code></pre>
<pre class="r"><code># Sobel’s test
#sobel(df2$femscale, df2$log_contrast, df2$mental_rot) # (mv,iv,dv)</code></pre>
<pre class="r"><code>fit.t4 = lm(mental_rot ~ log_contrast + Sex + vocab, df2)
summary(fit.t4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ log_contrast + Sex + vocab, data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.594  -3.880  -0.374   4.351  13.444 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)    9.9675     5.9138    1.69   0.0944 . 
## log_contrast  -9.6352     3.3631   -2.87   0.0049 **
## SexMales       2.6575     1.2574    2.11   0.0366 * 
## vocab         -0.0579     0.1091   -0.53   0.5967   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 123 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.113,  Adjusted R-squared:  0.091 
## F-statistic: 5.21 on 3 and 123 DF,  p-value: 0.00203</code></pre>
<pre class="r"><code>fit.Y4 = lm(mental_rot ~ femscale + log_contrast + Sex + vocab, df2)
summary(fit.Y4)</code></pre>
<pre><code>## 
## Call:
## lm(formula = mental_rot ~ femscale + log_contrast + Sex + vocab, 
##     data = df2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -12.496  -4.256  -0.284   4.546  12.754 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   11.8931     6.1445    1.94   0.0552 . 
## femscale      -2.3563     2.0714   -1.14   0.2575   
## log_contrast  -9.0002     3.4051   -2.64   0.0093 **
## SexMales       1.5447     1.5919    0.97   0.3338   
## vocab         -0.0751     0.1100   -0.68   0.4964   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.9 on 122 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.122,  Adjusted R-squared:  0.0932 
## F-statistic: 4.24 on 4 and 122 DF,  p-value: 0.00302</code></pre>
<pre class="r"><code>fit.M4 = lm(femscale ~ log_contrast + Sex, df2)
summary(fit.M4) # the total effect of f hobbies on our MRT is significant (p&lt;.05).</code></pre>
<pre><code>## 
## Call:
## lm(formula = femscale ~ log_contrast + Sex, data = df2)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -0.883 -0.138  0.036  0.174  0.760 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    0.7889     0.2579    3.06   0.0027 ** 
## log_contrast   0.2916     0.1463    1.99   0.0484 *  
## SexMales      -0.4759     0.0549   -8.67    2e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.26 on 124 degrees of freedom
##   (5 observations deleted due to missingness)
## Multiple R-squared:  0.419,  Adjusted R-squared:  0.41 
## F-statistic: 44.8 on 2 and 124 DF,  p-value: 2.33e-15</code></pre>
<pre class="r"><code># gvlma(fit.M)
# Step #3: The effect of the mediator on the dependent variable
# The mediator has a significant effect (p&lt;.05) on the dv.
# Step #4: Causal Mediation Analysis
results6 = mediate(fit.M4,
                   fit.Y4,
                   treat = &#39;log_contrast&#39;,
                   mediator = &#39;femscale&#39;,
                   boot = T) # Also, we need to specify boot=T as, by default, mediate will use a quasi-Bayesian approximation for confidence intervals. However, we want to report percentile confidence intervals, so we set it to T for true.</code></pre>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre class="r"><code>summary(results6)</code></pre>
<pre><code>## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value   
## ACME            -0.6871      -2.9332         0.55   0.324   
## ADE             -9.0002     -14.5235        -2.98   0.006 **
## Total Effect    -9.6873     -15.3859        -3.85   0.002 **
## Prop. Mediated   0.0709      -0.0687         0.35   0.326   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 127 
## 
## 
## Simulations: 1000</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
